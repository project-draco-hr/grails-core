{
  UrlMappingsHolder holder=WebUtils.lookupUrlMappings(getServletContext());
  String uri=urlHelper.getPathWithinApplication(request);
  if (!"/".equals(uri) && noControllers() && noRegexMappings(holder)) {
    processFilterChain(request,response,filterChain);
    return;
  }
  if (isUriExcluded(holder,uri)) {
    processFilterChain(request,response,filterChain);
    return;
  }
  if (LOG.isDebugEnabled()) {
    LOG.debug("Executing URL mapping filter...");
    LOG.debug(holder);
  }
  GrailsWebRequest webRequest=(GrailsWebRequest)request.getAttribute(GrailsApplicationAttributes.WEB_REQUEST);
  HttpServletRequest currentRequest=webRequest.getCurrentRequest();
  String version=findRequestedVersion(webRequest);
  UrlMappingInfo[] urlInfos=holder.matchAll(uri,currentRequest.getMethod(),version != null ? version : UrlMapping.ANY_VERSION);
  WrappedResponseHolder.setWrappedResponse(response);
  boolean dispatched=false;
  try {
    for (    UrlMappingInfo info : urlInfos) {
      if (info != null) {
        webRequest.resetParams();
        final String viewName;
        try {
          info.configure(webRequest);
          viewName=info.getViewName();
          if (viewName == null && info.getURI() == null) {
            Object featureId=getFeatureId(info);
            GrailsClass controller=application.getArtefactForFeature(ControllerArtefactHandler.TYPE,featureId);
            if (controller == null) {
              continue;
            }
            webRequest.setAttribute(GrailsApplicationAttributes.CONTROLLER_NAME_ATTRIBUTE,controller.getLogicalPropertyName(),WebRequest.SCOPE_REQUEST);
            webRequest.setAttribute(GrailsApplicationAttributes.GRAILS_CONTROLLER_CLASS,controller,WebRequest.SCOPE_REQUEST);
            webRequest.setAttribute(GrailsApplicationAttributes.GRAILS_CONTROLLER_CLASS_AVAILABLE,Boolean.TRUE,WebRequest.SCOPE_REQUEST);
          }
        }
 catch (        Exception e) {
          if (e instanceof MultipartException) {
            reapplySitemesh(request);
            throw ((MultipartException)e);
          }
          LOG.error("Error when matching URL mapping [" + info + "]:"+ e.getMessage(),e);
          continue;
        }
        dispatched=true;
        if (!WAR_DEPLOYED) {
          checkDevelopmentReloadingState(request);
        }
        request=checkMultipart(request);
        if (viewName == null || viewName.endsWith(GSP_SUFFIX) || viewName.endsWith(JSP_SUFFIX)) {
          if (info.isParsingRequest()) {
            webRequest.informParameterCreationListeners();
          }
          String forwardUrl=WebUtils.forwardRequestForUrlMappingInfo(request,response,info);
          if (LOG.isDebugEnabled()) {
            LOG.debug("Matched URI [" + uri + "] to URL mapping ["+ info+ "], forwarding to ["+ forwardUrl+ "] with response ["+ response.getClass()+ "]");
          }
        }
 else {
          if (!renderViewForUrlMappingInfo(request,response,info,viewName)) {
            dispatched=false;
          }
        }
        break;
      }
    }
  }
  finally {
    WrappedResponseHolder.setWrappedResponse(null);
  }
  if (!dispatched) {
    Set<HttpMethod> allowedHttpMethods=allowHeaderForWrongHttpMethod ? allowedMethods(holder,uri) : Collections.EMPTY_SET;
    if (allowedHttpMethods.isEmpty()) {
      if (LOG.isDebugEnabled()) {
        LOG.debug("No match found, processing remaining filter chain.");
      }
      processFilterChain(request,response,filterChain);
    }
 else {
      response.addHeader(HttpHeaders.ALLOW,DefaultGroovyMethods.join(allowedHttpMethods,","));
      response.sendError(HttpStatus.METHOD_NOT_ALLOWED.value());
    }
  }
}
