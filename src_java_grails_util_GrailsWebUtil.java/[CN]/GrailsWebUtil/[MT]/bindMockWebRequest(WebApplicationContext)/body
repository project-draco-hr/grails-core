{
  MockHttpServletRequest request=new MockHttpServletRequest();
  GrailsWebRequest webRequest=new GrailsWebRequest(request,new MockHttpServletResponse(),ctx.getServletContext());
  request.setAttribute(GrailsApplicationAttributes.WEB_REQUEST,webRequest);
  String[] paramListenerBeans=ctx.getBeanNamesForType(ParameterCreationListener.class);
  for (  String paramListenerBean : paramListenerBeans) {
    ParameterCreationListener creationListenerBean=(ParameterCreationListener)ctx.getBean(paramListenerBean);
    webRequest.addParameterListener(creationListenerBean);
  }
  RequestContextHolder.setRequestAttributes(webRequest);
  return webRequest;
}
