{
  Map<String,Map> dsConfigs=readDataSourceConfig();
  int transactionManagerBeanCount=0;
  for (  String beanName : registry.getBeanDefinitionNames()) {
    BeanDefinition beanDefinition=registry.getBeanDefinition(beanName);
    if (isValidTransactionManagerBeanDefinition(beanName,beanDefinition)) {
      String suffix=resolveDataSourceSuffix(beanName);
      if (beanName.equals(TRANSACTION_MANAGER) || !isNotTransactional(dsConfigs,suffix)) {
        transactionManagerBeanCount++;
      }
    }
  }
  return transactionManagerBeanCount;
}
