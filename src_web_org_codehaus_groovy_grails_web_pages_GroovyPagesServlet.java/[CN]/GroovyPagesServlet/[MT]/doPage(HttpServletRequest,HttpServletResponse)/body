{
  this.engine=grailsAttributes.getPagesTemplateEngine();
  this.engine.setShowSource(this.showSource);
  String pageId=engine.getPageId(request);
  URL pageUrl=engine.getPageUrl(context,pageId);
  if (pageUrl == null) {
    context.log("GroovyPagesServlet:  \"" + pageUrl + "\" not found");
    response.sendError(404,"\"" + pageUrl + "\" not found.");
    return;
  }
  Template t=engine.createTemplate(context,request,response);
  Writable w=t.make();
  Writer out=GSPResonseWriter.getInstance(response,8192);
  try {
    w.writeTo(out);
  }
 catch (  Exception e) {
    LOG.debug("Error processing GSP: " + e.getMessage(),e);
    request.setAttribute("exception",new GrailsWrappedRuntimeException(context,e));
    RequestDispatcher rd=request.getRequestDispatcher("/WEB-INF/grails-app/views/error.jsp");
    rd.forward(request,response);
  }
 finally {
    if (out != null)     out.close();
  }
}
