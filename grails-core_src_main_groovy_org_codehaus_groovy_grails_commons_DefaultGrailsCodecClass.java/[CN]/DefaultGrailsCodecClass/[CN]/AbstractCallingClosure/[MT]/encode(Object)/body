{
  if (target instanceof Encodeable) {
    return ((Encodeable)target).encode(this);
  }
  EncodingState encodingState=lookupEncodingState();
  if (encodingState != null && target instanceof CharSequence) {
    Set<String> tags=encodingState.getEncodingTagsFor((CharSequence)target);
    if (tags != null && tags.contains(codecName)) {
      return (CharSequence)target;
    }
  }
  Object encoded=callMethod(target);
  if (encodingState != null && encoded instanceof CharSequence)   encodingState.registerEncodedWith(codecName,(CharSequence)encoded);
  return (CharSequence)encoded;
}
