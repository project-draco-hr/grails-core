{
  GroovyAwareJavassistProxyFactory proxyFactory=new GroovyAwareJavassistProxyFactory();
  Set<Class> proxyInterfaces=new HashSet<Class>(){
{
      add(HibernateProxy.class);
    }
  }
;
  final Class javaClass=persistentClass.getMappedClass();
  final Property identifierProperty=persistentClass.getIdentifierProperty();
  final Getter idGetter=identifierProperty != null ? identifierProperty.getGetter(javaClass) : null;
  final Setter idSetter=identifierProperty != null ? identifierProperty.getSetter(javaClass) : null;
  if (idGetter == null || idSetter == null)   return null;
  try {
    proxyFactory.postInstantiate(persistentClass.getEntityName(),javaClass,proxyInterfaces,idGetter.getMethod(),idSetter.getMethod(),persistentClass.hasEmbeddedIdentifier() ? (AbstractComponentType)persistentClass.getIdentifier().getType() : null);
  }
 catch (  HibernateException e) {
    LOG.warn("Cannot instantiate proxy factory: " + e.getMessage());
    return null;
  }
  return proxyFactory;
}
