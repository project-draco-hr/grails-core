{
  Map dispatchParams=webRequest.getParams();
  String encoding=webRequest.getRequest().getCharacterEncoding();
  if (encoding == null)   encoding="UTF-8";
  for (  Map.Entry<String,Object> entry : params.entrySet()) {
    String name=entry.getKey();
    Object param=entry.getValue();
    if (param instanceof Closure) {
      param=evaluateNameForValue(param);
    }
    if (param instanceof String) {
      try {
        param=URLDecoder.decode((String)param,encoding);
      }
 catch (      UnsupportedEncodingException e) {
        param=evaluateNameForValue(param);
      }
    }
    dispatchParams.put(name,param);
  }
  final String viewName=getViewName();
  if (viewName == null && getURI() == null) {
    webRequest.setControllerName(getControllerName());
    webRequest.setActionName(getActionName());
  }
  String id=getId();
  if (!StringUtils.isBlank(id))   try {
    dispatchParams.put(GrailsWebRequest.ID_PARAMETER,URLDecoder.decode(id,encoding));
  }
 catch (  UnsupportedEncodingException e) {
    dispatchParams.put(GrailsWebRequest.ID_PARAMETER,id);
  }
}
