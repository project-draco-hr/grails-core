{
  String[] beanNames=beanFactory.getBeanNamesForType(PlatformTransactionManager.class);
  if (beanNames.length > 0) {
    PlatformTransactionManager ptm=(PlatformTransactionManager)beanFactory.getBean(beanNames[0]);
    Map beans=beanFactory.getBeansOfType(TransactionManagerAware.class);
    for (Iterator i=beans.values().iterator(); i.hasNext(); ) {
      TransactionManagerAware tma=(TransactionManagerAware)i.next();
      tma.setTransactionManager(ptm);
    }
  }
}
