{
  MutableAttributeMap flowScope=context.getFlowScope();
  if (flowScope.get(PERSISTENCE_CONTEXT_ATTRIBUTE) != null) {
    return;
  }
  SessionHolder sessionHolder=(SessionHolder)TransactionSynchronizationManager.getResource(localSessionFactory);
  if (sessionHolder != null) {
    flowScope.put(PERSISTENCE_CONTEXT_ATTRIBUTE,sessionHolder.getSession());
  }
}
