{
  if (parent != null && beanFactory != null) {
    if (beanFactory instanceof DefaultListableBeanFactory) {
      return new GrailsApplicationContext((DefaultListableBeanFactory)beanFactory,parent);
    }
 else {
      throw new IllegalArgumentException("ListableBeanFactory set must be a subclass of DefaultListableBeanFactory");
    }
  }
 else   if (beanFactory != null) {
    if (beanFactory instanceof DefaultListableBeanFactory) {
      return new GrailsApplicationContext((DefaultListableBeanFactory)beanFactory);
    }
 else {
      throw new IllegalArgumentException("ListableBeanFactory set must be a subclass of DefaultListableBeanFactory");
    }
  }
 else   if (parent != null) {
    return new GrailsApplicationContext(parent);
  }
 else {
    return new GrailsApplicationContext();
  }
}
