{
  final GroovyPageTagWriter capturedOut=new GroovyPageTagWriter(preferSubChunkWhenWritingToOtherBuffer);
  Binding currentBinding=(Binding)webRequest.getCurrentRequest().getAttribute(GrailsApplicationAttributes.PAGE_SCOPE);
  Map<String,Object> savedVariablesMap=null;
  Object originalIt=null;
  try {
    pushCapturedOut(capturedOut);
    Object bodyResult;
    if (hasArgument) {
      originalIt=saveItVariable(currentBinding,args);
    }
    if (args instanceof Map && ((Map)args).size() > 0) {
      savedVariablesMap=addAndSaveVariables(currentBinding,(Map)args);
    }
    bodyResult=executeClosure(args);
    if (!capturedOut.isUsed() && bodyResult != null && !(bodyResult instanceof Writer)) {
      return bodyResult;
    }
    return capturedOut.getBuffer();
  }
  finally {
    restoreVariables(currentBinding,savedVariablesMap);
    if (hasArgument) {
      restoreItVariable(currentBinding,originalIt);
    }
    popCapturedOut();
  }
}
