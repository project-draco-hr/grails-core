{
  String in=(String)attributes.get(ATTRIBUTE_IN);
  String filter=(String)attributes.get(ATTRIBUTE_FILTER);
  if (StringUtils.isBlank(in))   throw new GrailsTagException("Tag [" + TAG_NAME + "] missing required attribute ["+ ATTRIBUTE_IN+ "]");
  if (StringUtils.isBlank(filter))   throw new GrailsTagException("Tag [" + TAG_NAME + "] missing required attribute ["+ ATTRIBUTE_FILTER+ "]");
  out.print(in);
  out.print(".grep (");
  if (filter.startsWith("\"") && filter.endsWith("\"")) {
    filter=filter.substring(1,filter.length() - 1);
  }
  out.print(filter);
  out.println(").each {");
}
