{
  try {
    final GroovyAwareJavassistLazyInitializer instance=new GroovyAwareJavassistLazyInitializer(entityName,persistentClass,interfaces,id,getIdentifierMethod,setIdentifierMethod,componentIdType,session);
    ProxyFactory factory=createProxyFactory(persistentClass,interfaces);
    Class<?> proxyClass=factory.createClass();
    HibernatePluginSupport.enhanceProxyClass(proxyClass);
    final HibernateProxy proxy=(HibernateProxy)proxyClass.newInstance();
    ((ProxyObject)proxy).setHandler(instance);
    HibernatePluginSupport.enhanceProxy(proxy);
    instance.constructed=true;
    return proxy;
  }
 catch (  Throwable t) {
    LogFactory.getLog(BasicLazyInitializer.class).error("Javassist Enhancement failed: " + entityName,t);
    throw new HibernateException("Javassist Enhancement failed: " + entityName,t);
  }
}
