{
  RequestAttributes requestAttributes=RequestContextHolder.getRequestAttributes();
  if (!(requestAttributes instanceof GrailsWebRequest)) {
    return ContextLoader.getCurrentWebApplicationContext();
  }
  return ((GrailsWebRequest)requestAttributes).getApplicationContext();
}
