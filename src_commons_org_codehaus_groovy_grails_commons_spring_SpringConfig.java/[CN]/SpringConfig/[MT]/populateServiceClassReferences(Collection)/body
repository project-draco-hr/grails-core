{
  GrailsServiceClass[] serviceClasses=application.getGrailsServiceClasses();
  for (int i=0; i < serviceClasses.length; i++) {
    GrailsServiceClass grailsServiceClass=serviceClasses[i];
    Bean serviceClass=SpringConfigUtils.createSingletonBean(MethodInvokingFactoryBean.class);
    serviceClass.setProperty("targetObject",SpringConfigUtils.createBeanReference("grailsApplication"));
    serviceClass.setProperty("targetMethod",SpringConfigUtils.createLiteralValue("getGrailsServiceClass"));
    serviceClass.setProperty("arguments",SpringConfigUtils.createLiteralValue(grailsServiceClass.getFullName()));
    beanReferences.add(SpringConfigUtils.createBeanReference(grailsServiceClass.getFullName() + "Class",serviceClass));
    Bean serviceInstance=SpringConfigUtils.createSingletonBean();
    serviceInstance.setFactoryBean(SpringConfigUtils.createBeanReference(grailsServiceClass.getFullName() + "Class"));
    serviceInstance.setFactoryMethod("newInstance");
    if (grailsServiceClass.byName()) {
      serviceInstance.setAutowire("byName");
    }
 else     if (grailsServiceClass.byType()) {
      serviceInstance.setAutowire("byType");
    }
    if (grailsServiceClass.isTransactional()) {
      Map transactionAttributes=new HashMap();
      transactionAttributes.put("*","PROPAGATION_REQUIRED");
      Bean transactionalProxy=SpringConfigUtils.createSingletonBean(TransactionProxyFactoryBean.class);
      transactionalProxy.setProperty("target",serviceInstance);
      transactionalProxy.setProperty("proxyTargetClass",SpringConfigUtils.createLiteralValue("true"));
      transactionalProxy.setProperty("transactionAttributes",SpringConfigUtils.createProperties(transactionAttributes));
      transactionalProxy.setProperty("transactionManager",SpringConfigUtils.createBeanReference("transactionManager"));
      beanReferences.add(SpringConfigUtils.createBeanReference(WordUtils.uncapitalize(grailsServiceClass.getName()) + "Service",transactionalProxy));
    }
 else {
      beanReferences.add(SpringConfigUtils.createBeanReference(WordUtils.uncapitalize(grailsServiceClass.getName()) + "Service",serviceInstance));
    }
  }
}
