{
  GroovyClassLoader cl=new GroovyClassLoader();
  cl.parseClass("class Visit {\n" + "    Long id \n" + "    Long version \n"+ "    String description \n"+ "} \n"+ "class Pet {\n"+ "    Long id \n"+ "    Long version \n"+ "    Set visits \n"+ "    static hasMany = [visits:Visit] \n"+ "}");
  DefaultGrailsDomainConfiguration config=getDomainConfig(cl,cl.getLoadedClasses());
  PersistentClass visitClass=config.getClassMapping("Visit");
  Iterator fks=config.getCollectionMapping("Pet.visits").getCollectionTable().getForeignKeyIterator();
  assertTrue("VISIT table has a FK",fks.hasNext());
  if (fks.hasNext()) {
    ForeignKey fk=(ForeignKey)fks.next();
    assertEquals("FK references table","pet",fk.getReferencedTable().getName());
  }
}
