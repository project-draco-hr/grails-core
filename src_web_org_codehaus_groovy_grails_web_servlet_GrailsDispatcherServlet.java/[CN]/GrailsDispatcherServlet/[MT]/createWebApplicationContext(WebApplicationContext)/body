{
  WebApplicationContext wac=WebApplicationContextUtils.getWebApplicationContext(getServletContext());
  WebApplicationContext webContext;
  Assert.notNull(parent,"Grails requires a parent ApplicationContext, is the /WEB-INF/applicationContext.xml file missing?");
  this.application=(GrailsApplication)parent.getBean(GrailsApplication.APPLICATION_ID,GrailsApplication.class);
  if (wac instanceof GrailsApplicationContext) {
    webContext=wac;
  }
 else {
    webContext=GrailsConfigUtils.configureWebApplicationContext(getServletContext(),parent);
    GrailsConfigUtils.executeGrailsBootstraps(application,webContext,getServletContext());
  }
  initGrailsController(webContext);
  this.interceptors=establishInterceptors(webContext);
  return webContext;
}
