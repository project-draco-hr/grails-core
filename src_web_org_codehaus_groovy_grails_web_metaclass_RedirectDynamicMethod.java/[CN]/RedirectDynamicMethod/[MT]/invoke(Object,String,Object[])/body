{
  if (arguments.length == 0)   throw new MissingMethodException(METHOD_SIGNATURE,target.getClass(),arguments);
  Map argMap=arguments[0] instanceof Map ? (Map)arguments[0] : Collections.EMPTY_MAP;
  if (argMap.size() == 0) {
    throw new MissingMethodException(METHOD_SIGNATURE,target.getClass(),arguments);
  }
  Object actionRef=argMap.get(ARGUMENT_ACTION);
  String controllerName=argMap.containsKey(ARGUMENT_CONTROLLER) ? argMap.get(ARGUMENT_CONTROLLER).toString() : null;
  Object id=argMap.get(ARGUMENT_ID);
  Object uri=argMap.get(ARGUMENT_URI);
  String url=argMap.containsKey(ARGUMENT_URL) ? argMap.get(ARGUMENT_URL).toString() : null;
  Map params=(Map)argMap.get(ARGUMENT_PARAMS);
  if (params == null)   params=new HashMap();
  Errors errors=(Errors)argMap.get(ARGUMENT_ERRORS);
  GroovyObject controller=(GroovyObject)target;
  Errors controllerErrors=(Errors)controller.getProperty(ControllerDynamicMethods.ERRORS_PROPERTY);
  if (controllerErrors != null) {
    controllerErrors.addAllErrors(errors);
  }
 else {
    controller.setProperty(ControllerDynamicMethods.ERRORS_PROPERTY,errors);
  }
  String actualUri;
  GrailsWebRequest webRequest=(GrailsWebRequest)RequestContextHolder.currentRequestAttributes();
  GrailsApplicationAttributes attrs=webRequest.getAttributes();
  HttpServletRequest request=webRequest.getCurrentRequest();
  GrailsHttpServletResponse response=webRequest.getCurrentResponse();
  StringBuffer actualUriBuf=new StringBuffer(attrs.getApplicationUri(request));
  if (uri != null) {
    actualUri=attrs.getApplicationUri(request) + uri.toString();
  }
 else   if (url != null) {
    actualUri=url;
  }
 else {
    String actionName=establishActionName(actionRef,target,webRequest);
    controllerName=controllerName != null ? controllerName : webRequest.getControllerName();
    if (LOG.isDebugEnabled()) {
      LOG.debug("Dynamic method [redirect] looking up URL mapping for controller [" + controllerName + "] and action ["+ actionName+ "] and params ["+ params+ "] with ["+ urlMappingsHolder+ "]");
    }
    boolean found=false;
    try {
      UrlMapping urlMapping=null;
      if (id != null)       params.put(ARGUMENT_ID,id);
      if (urlMappingsHolder != null) {
        urlMapping=urlMappingsHolder.getReverseMapping(controllerName,actionName,params);
      }
      if (LOG.isDebugEnabled() && urlMapping == null) {
        LOG.debug("Dynamic method [redirect] no URL mapping found for params [" + params + "]");
      }
      if (urlMapping != null) {
        found=true;
        params.put(ARGUMENT_CONTROLLER,controllerName);
        params.put(ARGUMENT_ACTION,actionName != null ? actionName : webRequest.getActionName());
        String mappedUrl=urlMapping.createURL(params);
        if (LOG.isDebugEnabled()) {
          LOG.debug("Dynamic method [redirect] mapped to URL [" + mappedUrl + "]");
        }
        actualUriBuf.append(mappedUrl);
      }
    }
  finally {
      if (id != null)       params.remove(ARGUMENT_ID);
      params.remove(ARGUMENT_CONTROLLER);
      params.remove(ARGUMENT_ACTION);
    }
    if (!found) {
      if (actionName != null) {
        if (actionName.indexOf(SLASH) > -1) {
          actualUriBuf.append(actionName);
        }
 else {
          if (controllerName != null) {
            appendUrlToken(actualUriBuf,controllerName);
          }
 else {
            actualUriBuf.append(attrs.getControllerUri(request));
          }
        }
        appendUrlToken(actualUriBuf,actionName);
      }
 else {
        throw new ControllerExecutionException("Action not found in redirect for name [" + actionName + "]");
      }
      if (id != null) {
        appendUrlToken(actualUriBuf,id);
      }
      if (params != null) {
        appendRequestParams(actualUriBuf,params,request);
      }
    }
    actualUri=actualUriBuf.toString();
  }
  return redirectResponse(actualUri,response);
}
