{
  Object value=classPropertyFetcher.getPropertyValue(name);
  if (value == null) {
    Object inst=getReferenceInstance();
    if (inst instanceof GroovyObject) {
      MetaProperty metaProperty=getMetaClass().getMetaProperty(name);
      if (metaProperty != null) {
        value=metaProperty.getProperty(inst);
      }
    }
  }
  return returnOnlyIfInstanceOf(value,type);
}
