{
  if (StringUtils.isBlank(controller)) {
    throw new JspTagException("Tag link missing required attribute 'controller'");
  }
  Writer out=super.pageContext.getOut();
  Map attributes=new HashMap();
  attributes.putAll(this.dyanmicAttributes);
  attributes.put(LinkTag.ATTRIBUTE_CONTROLLER,controller);
  if (!StringUtils.isBlank(action)) {
    attributes.put(LinkTag.ATTRIBUTE_ACTION,action);
  }
  if (!StringUtils.isBlank(id)) {
    Object evalId;
    if (ExpressionEvaluationUtils.isExpressionLanguage(id)) {
      evalId=ExpressionEvaluationUtils.evaluate("id",id,Object.class,pageContext);
    }
 else {
      evalId=pageContext.findAttribute(id);
      if (evalId == null)       evalId=id;
    }
    attributes.put(LinkTag.ATTRIBUTE_ID,evalId);
  }
  GrailsTagRegistry tagRegistry=GrailsTagRegistry.getInstance();
  Map tagContext=new HashMap();
  tagContext.put(GroovyPage.REQUEST,pageContext.getRequest());
  tagContext.put(GroovyPage.RESPONSE,pageContext.getResponse());
  tagContext.put(GroovyPage.SERVLET_CONTEXT,pageContext.getServletContext());
  this.tag=tagRegistry.newTag(LinkTag.TAG_NAME);
  this.tag.init(tagContext);
  this.tag.setAttributes(attributes);
  tag.doStartTag();
  return EVAL_BODY_BUFFERED;
}
