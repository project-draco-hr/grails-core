{
  if (trouble || obj == null) {
    usageFlag=true;
    return;
  }
  Object encoded=encodeObject(obj);
  if (encoded == null)   return;
  Class<?> clazz=encoded.getClass();
  if (clazz == String.class) {
    super.write((String)encoded);
  }
 else   if (clazz == StreamCharBuffer.class) {
    super.write((StreamCharBuffer)encoded);
  }
 else   if (encoded instanceof Writable) {
    super.write((Writable)encoded);
  }
 else   if (obj instanceof CharSequence) {
    try {
      usageFlag=true;
      out.append((CharSequence)encoded);
    }
 catch (    IOException e) {
      handleIOException(e);
    }
  }
 else {
    super.write(String.valueOf(encoded));
  }
}
