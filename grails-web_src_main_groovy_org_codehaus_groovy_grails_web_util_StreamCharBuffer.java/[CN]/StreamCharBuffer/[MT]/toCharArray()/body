{
  if (firstChunk == lastChunk && firstChunk instanceof CharBufferChunk && allocBuffer.charsUsed() == 0 && ((CharBufferChunk)firstChunk).isSingleBuffer()) {
    return ((CharBufferChunk)firstChunk).buffer;
  }
  int initialReaderCount=readerCount;
  EncodingState encodingState=null;
  if (firstChunk != null) {
    encodingState=firstChunk.getEncodingState();
  }
 else {
    encodingState=allocBuffer.getEncodingState();
  }
  char[] buf=readAsCharArray();
  if (initialReaderCount == 0) {
    reset();
    if (buf.length > 0) {
      addChunk(new CharBufferChunk(-1,buf,0,buf.length)).setEncodingState(encodingState);
    }
  }
  return buf;
}
