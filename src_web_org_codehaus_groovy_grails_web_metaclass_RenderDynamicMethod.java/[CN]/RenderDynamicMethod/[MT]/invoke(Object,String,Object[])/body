{
  if (arguments.length == 0)   throw new MissingMethodException(METHOD_SIGNATURE,target.getClass(),arguments);
  GrailsWebRequest webRequest=(GrailsWebRequest)RequestContextHolder.currentRequestAttributes();
  GrailsApplication application=webRequest.getAttributes().getGrailsApplication();
  HttpServletRequest request=webRequest.getCurrentRequest();
  HttpServletResponse response=webRequest.getCurrentResponse();
  boolean renderView=true;
  GroovyObject controller=(GroovyObject)target;
  if (response.getContentType() == null)   response.setContentType("text/html");
  if ((arguments[0] instanceof String) || (arguments[0] instanceof GString)) {
    try {
      response.getWriter().write(arguments[0].toString());
      renderView=false;
    }
 catch (    IOException e) {
      throw new ControllerExecutionException(e.getMessage(),e);
    }
  }
 else   if (arguments[0] instanceof Closure) {
    StreamingMarkupBuilder b=new StreamingMarkupBuilder();
    Writable markup=(Writable)b.bind(arguments[arguments.length - 1]);
    try {
      markup.writeTo(response.getWriter());
    }
 catch (    IOException e) {
      throw new ControllerExecutionException("I/O error executing render method for arguments [" + arguments[0] + "]: "+ e.getMessage(),e);
    }
    renderView=false;
  }
 else   if (arguments[0] instanceof Map) {
    Map argMap=(Map)arguments[0];
    Writer out;
    if (argMap.containsKey(ARGUMENT_TO)) {
      out=(Writer)argMap.get(ARGUMENT_TO);
    }
 else     if (argMap.containsKey(ARGUMENT_CONTENT_TYPE) && argMap.containsKey(ARGUMENT_ENCODING)) {
      String contentType=argMap.get(ARGUMENT_CONTENT_TYPE).toString();
      String encoding=argMap.get(ARGUMENT_ENCODING).toString();
      response.setContentType(contentType + ";charset=" + encoding);
      out=GSPResponseWriter.getInstance(response,BUFFER_SIZE);
    }
 else     if (argMap.containsKey(ARGUMENT_CONTENT_TYPE)) {
      response.setContentType(argMap.get(ARGUMENT_CONTENT_TYPE).toString());
      out=GSPResponseWriter.getInstance(response,BUFFER_SIZE);
    }
 else {
      out=GSPResponseWriter.getInstance(response,BUFFER_SIZE);
    }
    webRequest.setOut(out);
    if (arguments[arguments.length - 1] instanceof Closure) {
      if (BUILDER_TYPE_RICO.equals(argMap.get(ARGUMENT_BUILDER))) {
        OpenRicoBuilder orb;
        try {
          orb=new OpenRicoBuilder(response);
          renderView=false;
        }
 catch (        IOException e) {
          throw new ControllerExecutionException("I/O error executing render method for arguments [" + argMap + "]: "+ e.getMessage(),e);
        }
        orb.invokeMethod("ajax",new Object[]{arguments[arguments.length - 1]});
      }
 else       if (BUILDER_TYPE_JSON.equals(argMap.get(ARGUMENT_BUILDER)) || isJSONResponse(response)) {
        JSonBuilder jsonBuilder;
        try {
          jsonBuilder=new JSonBuilder(response);
          renderView=false;
        }
 catch (        IOException e) {
          throw new ControllerExecutionException("I/O error executing render method for arguments [" + argMap + "]: "+ e.getMessage(),e);
        }
        jsonBuilder.invokeMethod("json",new Object[]{arguments[arguments.length - 1]});
      }
 else {
        StreamingMarkupBuilder b=new StreamingMarkupBuilder();
        Closure callable=(Closure)arguments[arguments.length - 1];
        Writable markup=(Writable)b.bind(callable);
        try {
          markup.writeTo(out);
        }
 catch (        IOException e) {
          throw new ControllerExecutionException("I/O error executing render method for arguments [" + argMap + "]: "+ e.getMessage(),e);
        }
        renderView=false;
      }
    }
 else     if (arguments[arguments.length - 1] instanceof String) {
      try {
        out.write((String)arguments[arguments.length - 1]);
      }
 catch (      IOException e) {
        throw new ControllerExecutionException("I/O error executing render method for arguments [" + arguments[arguments.length - 1] + "]: "+ e.getMessage(),e);
      }
      renderView=false;
    }
 else     if (argMap.containsKey(ARGUMENT_TEXT)) {
      String text=argMap.get(ARGUMENT_TEXT).toString();
      try {
        out.write(text);
      }
 catch (      IOException e) {
        throw new ControllerExecutionException("I/O error executing render method for arguments [" + argMap + "]: "+ e.getMessage(),e);
      }
      renderView=false;
    }
 else     if (argMap.containsKey(ARGUMENT_VIEW)) {
      String viewName=argMap.get(ARGUMENT_VIEW).toString();
      GrailsControllerClass controllerClass=(GrailsControllerClass)application.getArtefact(ControllerArtefactHandler.TYPE,target.getClass().getName());
      if (controllerClass == null && webRequest.getControllerName() != null) {
        controllerClass=(GrailsControllerClass)application.getArtefactByLogicalPropertyName(ControllerArtefactHandler.TYPE,webRequest.getControllerName());
      }
      String viewUri;
      if (viewName.indexOf('/') > -1) {
        if (!viewName.startsWith("/")) {
          viewName='/' + viewName;
        }
        viewUri=viewName;
      }
 else {
        viewUri=controllerClass.getViewByName(viewName);
      }
      Map model;
      Object modelObject=argMap.get(ARGUMENT_MODEL);
      if (modelObject instanceof Map) {
        model=(Map)modelObject;
      }
 else       if (controllerClass.getClazz().isInstance(target)) {
        model=new BeanMap(target);
      }
 else {
        model=new HashMap();
      }
      controller.setProperty(ControllerDynamicMethods.MODEL_AND_VIEW_PROPERTY,new ModelAndView(viewUri,model));
    }
 else     if (argMap.containsKey(ARGUMENT_TEMPLATE)) {
      String templateName=argMap.get(ARGUMENT_TEMPLATE).toString();
      String var=(String)argMap.get(ARGUMENT_VAR);
      GrailsApplicationAttributes attrs=(GrailsApplicationAttributes)controller.getProperty(ControllerDynamicMethods.GRAILS_ATTRIBUTES);
      String templateUri=attrs.getTemplateUri(templateName,request);
      GroovyPagesTemplateEngine engine=attrs.getPagesTemplateEngine();
      try {
        Template t=engine.createTemplate(templateUri);
        if (t == null) {
          throw new ControllerExecutionException("Unable to load template for uri [" + templateUri + "]. Template not found.");
        }
        Map binding=new HashMap();
        if (argMap.containsKey(ARGUMENT_BEAN)) {
          if (StringUtils.isBlank(var))           binding.put(DEFAULT_ARGUMENT,argMap.get(ARGUMENT_BEAN));
 else           binding.put(var,argMap.get(ARGUMENT_BEAN));
          Writable w=t.make(binding);
          w.writeTo(out);
        }
 else         if (argMap.containsKey(ARGUMENT_COLLECTION)) {
          Object colObject=argMap.get(ARGUMENT_COLLECTION);
          if (colObject instanceof Collection) {
            Collection c=(Collection)colObject;
            for (Iterator i=c.iterator(); i.hasNext(); ) {
              Object o=i.next();
              if (StringUtils.isBlank(var))               binding.put(DEFAULT_ARGUMENT,o);
 else               binding.put(var,o);
              Writable w=t.make(binding);
              w.writeTo(out);
            }
          }
 else {
            if (StringUtils.isBlank(var))             binding.put(DEFAULT_ARGUMENT,argMap.get(ARGUMENT_BEAN));
 else             binding.put(var,colObject);
            Writable w=t.make(binding);
            w.writeTo(out);
          }
        }
 else         if (argMap.containsKey(ARGUMENT_MODEL)) {
          Object modelObject=argMap.get(ARGUMENT_MODEL);
          if (modelObject instanceof Map) {
            Writable w=t.make((Map)argMap.get(ARGUMENT_MODEL));
            w.writeTo(out);
          }
 else {
            Writable w=t.make(new BeanMap(target));
            w.writeTo(out);
          }
        }
 else {
          Writable w=t.make(new BeanMap(target));
          w.writeTo(out);
        }
        renderView=false;
      }
 catch (      GroovyRuntimeException gre) {
        throw new ControllerExecutionException("Error rendering template [" + templateName + "]: "+ gre.getMessage(),gre);
      }
catch (      IOException ioex) {
        throw new ControllerExecutionException("I/O error executing render method for arguments [" + argMap + "]: "+ ioex.getMessage(),ioex);
      }
    }
 else {
      try {
        out.write(DefaultGroovyMethods.inspect(arguments[0]));
        renderView=false;
      }
 catch (      IOException e) {
        throw new ControllerExecutionException("I/O error obtaining response writer: " + e.getMessage(),e);
      }
    }
    try {
      if (!renderView)       out.flush();
    }
 catch (    IOException e) {
      throw new ControllerExecutionException("I/O error executing render method for arguments [" + argMap + "]: "+ e.getMessage(),e);
    }
  }
 else {
    throw new MissingMethodException(METHOD_SIGNATURE,target.getClass(),arguments);
  }
  webRequest.setRenderView(renderView);
  return null;
}
