{
  Class type=bean.getPropertyType(propertyName);
  if (type == null) {
    GrailsDomainClass gdc=domainClass;
    for (    String path : propertyName.replaceAll("\\[.+?\\]","").split("\\.")) {
      GrailsDomainClassProperty prop=gdc.getPropertyByName(path);
      gdc=prop.getReferencedDomainClass();
    }
    type=gdc.getClazz();
  }
  return type;
}
