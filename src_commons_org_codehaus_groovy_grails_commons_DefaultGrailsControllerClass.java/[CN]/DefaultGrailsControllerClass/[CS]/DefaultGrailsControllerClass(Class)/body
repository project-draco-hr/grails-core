{
  super(clazz,CONTROLLER);
  this.uri=SLASH + (StringUtils.isNotBlank(getPackageName()) ? getPackageName().replace('.','/') + SLASH : "") + WordUtils.uncapitalize(getName());
  String defaultActionName=(String)getPropertyOrStaticPropertyOrFieldValue(DEFAULT_CLOSURE_PROPERTY,String.class);
  if (defaultActionName == null) {
    defaultActionName=INDEX_ACTION;
  }
  this.scaffoldedClass=(Class)getPropertyOrStaticPropertyOrFieldValue(SCAFFOLDING_PROPERTY,Class.class);
  if (this.scaffoldedClass != null) {
    this.scaffolding=true;
  }
 else {
    if (getReference().isReadableProperty(SCAFFOLDING_PROPERTY)) {
      Object tmp=getReference().getPropertyValue(SCAFFOLDING_PROPERTY);
      if (tmp instanceof Boolean) {
        this.scaffolding=((Boolean)tmp).booleanValue();
      }
    }
  }
  Collection closureNames=new ArrayList();
  this.uri2viewMap=new HashMap();
  this.uri2closureMap=new HashMap();
  this.viewNames=new HashMap();
  if (this.scaffolding) {
    this.uri2closureMap.put(uri,defaultActionName);
    this.uri2closureMap.put(uri + SLASH,defaultActionName);
    this.uri2viewMap.put(uri + SLASH,uri + SLASH + defaultActionName);
    this.uri2viewMap.put(uri,uri + SLASH + defaultActionName);
    this.viewNames.put(defaultActionName,uri + SLASH + defaultActionName);
    for (int i=0; i < DefaultGrailsScaffolder.ACTION_NAMES.length; i++) {
      closureNames.add(DefaultGrailsScaffolder.ACTION_NAMES[i]);
      String viewName=(String)getPropertyOrStaticPropertyOrFieldValue(DefaultGrailsScaffolder.ACTION_NAMES[i] + VIEW,String.class);
      if (viewName == null) {
        viewName=DefaultGrailsScaffolder.ACTION_NAMES[i];
      }
      String tmpUri=uri + SLASH + DefaultGrailsScaffolder.ACTION_NAMES[i];
      String viewUri=uri + SLASH + viewName;
      if (StringUtils.isNotBlank(viewName)) {
        this.uri2viewMap.put(tmpUri,viewUri);
        this.viewNames.put(DefaultGrailsScaffolder.ACTION_NAMES[i],viewUri);
      }
      this.uri2closureMap.put(tmpUri,DefaultGrailsScaffolder.ACTION_NAMES[i]);
      this.uri2closureMap.put(tmpUri + SLASH + "**",DefaultGrailsScaffolder.ACTION_NAMES[i]);
    }
  }
  PropertyDescriptor[] propertyDescriptors=getReference().getPropertyDescriptors();
  for (int i=0; i < propertyDescriptors.length; i++) {
    PropertyDescriptor propertyDescriptor=propertyDescriptors[i];
    Closure closure=(Closure)getPropertyOrStaticPropertyOrFieldValue(propertyDescriptor.getName(),Closure.class);
    if (closure != null) {
      closureNames.add(propertyDescriptor.getName());
      String closureName=propertyDescriptor.getName();
      String viewName=(String)getPropertyOrStaticPropertyOrFieldValue(propertyDescriptor.getName() + VIEW,String.class);
      if (viewName == null) {
        viewName=propertyDescriptor.getName();
      }
      String tmpUri=uri + SLASH + propertyDescriptor.getName();
      String viewUri=uri + SLASH + viewName;
      uri2closureMap.put(tmpUri,closureName);
      uri2closureMap.put(tmpUri + SLASH + "**",closureName);
      if (StringUtils.isNotBlank(viewName)) {
        this.uri2viewMap.put(tmpUri,viewUri);
        this.viewNames.put(closureName,viewUri);
      }
    }
  }
  if (getReference().isReadableProperty(defaultActionName)) {
    this.uri2closureMap.put(uri,defaultActionName);
    this.uri2closureMap.put(uri + SLASH,defaultActionName);
    this.uri2viewMap.put(uri + SLASH,uri + SLASH + defaultActionName);
    this.uri2viewMap.put(uri,uri + SLASH + defaultActionName);
    this.viewNames.put(defaultActionName,uri + SLASH + defaultActionName);
  }
  if (closureNames.size() == 1) {
    String closureName=((String)closureNames.iterator().next());
    this.uri2closureMap.put(uri,closureName);
    this.uri2closureMap.put(uri + SLASH,closureName);
    if (!this.uri2viewMap.isEmpty()) {
      this.uri2viewMap.put(uri,this.uri2viewMap.values().iterator().next());
    }
  }
  this.uris=(String[])this.uri2closureMap.keySet().toArray(new String[this.uri2closureMap.keySet().size()]);
}
