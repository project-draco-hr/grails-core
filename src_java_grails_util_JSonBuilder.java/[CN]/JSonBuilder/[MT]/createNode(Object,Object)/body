{
  if (getCurrent() == null && stack.peek().equals(Mode.OBJECT)) {
    throw new IllegalArgumentException(JSON_BUILDER + "only call to [element { }] is allowed when creating array");
  }
  try {
    int retVal=0;
    if (stack.peek().equals(Mode.ARRAY)) {
      writeObject();
      retVal=1;
    }
    if (value instanceof Collection) {
      writer.key(String.valueOf(key));
      handleCollectionRecurse((Collection)value);
    }
 else {
      writer.key(String.valueOf(key)).value(value);
    }
    return retVal != 0 ? new Integer(retVal) : null;
  }
 catch (  JSONException e) {
    throw new IllegalArgumentException(JSON_BUILDER + "invalid element");
  }
}
