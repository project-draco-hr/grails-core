{
  try {
    FlowExecutionContext context=FlowExecutionContextHolder.getFlowExecutionContext();
    MutableAttributeMap flowScope=context.getActiveSession().getScope();
    Session s=(Session)flowScope.get("session",org.hibernate.Session.class);
    if (s == null)     return super.currentSession();
 else     return s;
  }
 catch (  IllegalStateException e) {
    return super.currentSession();
  }
}
