{
  if (ExpressionEvaluationUtils.isSpringJspExpressionSupportActive(pageContext) && ExpressionEvaluationUtils.isExpressionLanguage(attrValue)) {
    return ExpressionEvaluationUtils.doEvaluate(attrName,attrValue,resultClass,pageContext);
  }
 else   if (attrValue != null && resultClass != null && !resultClass.isInstance(attrValue)) {
    throw new JspException("Attribute value \"" + attrValue + "\" is neither a JSP EL expression nor "+ "assignable to result class ["+ resultClass.getName()+ "]");
  }
 else {
    return attrValue;
  }
}
