{
  if (defaultConstraints != null && !defaultConstraints.isEmpty()) {
    if (defaultConstraints.containsKey("*")) {
      final Object o=defaultConstraints.get("*");
      if (o instanceof Map) {
        Map<String,Object> globalConstraints=(Map<String,Object>)o;
        applyMapOfConstraints(globalConstraints,propertyName,p,cp);
      }
    }
    if (sharedConstraintReference != null) {
      final Object o=defaultConstraints.get(sharedConstraintReference);
      if (o instanceof Map) {
        applyMapOfConstraints((Map)o,propertyName,p,cp);
      }
 else {
        throw new GrailsConfigurationException("Domain class property [" + p.getDomainClass().getFullName() + '.'+ p.getName()+ "] references shared constraint ["+ sharedConstraintReference+ ":"+ o+ "], which doesn't exist!");
      }
    }
  }
  if (canApplyNullableConstraint(propertyName,p,cp)) {
    if (propertyConfig != null && !propertyConfig.getInsertable()) {
      cp.applyConstraint(ConstrainedProperty.NULLABLE_CONSTRAINT,true);
    }
 else {
      cp.applyConstraint(ConstrainedProperty.NULLABLE_CONSTRAINT,Collection.class.isAssignableFrom(p.getType()) || Map.class.isAssignableFrom(p.getType()));
    }
  }
}
