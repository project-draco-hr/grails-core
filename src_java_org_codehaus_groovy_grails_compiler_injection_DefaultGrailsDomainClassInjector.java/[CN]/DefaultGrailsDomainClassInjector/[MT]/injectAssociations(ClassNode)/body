{
  List<PropertyNode> propertiesToAdd=new ArrayList<PropertyNode>();
  for (  PropertyNode pn : classNode.getProperties()) {
    final String name=pn.getName();
    final boolean isHasManyProperty=name.equals(GrailsDomainClassProperty.RELATES_TO_MANY) || name.equals(GrailsDomainClassProperty.HAS_MANY);
    if (isHasManyProperty) {
      Expression e=pn.getInitialExpression();
      propertiesToAdd.addAll(createPropertiesForHasManyExpression(e,classNode));
    }
    final boolean isBelongsTo=name.equals(GrailsDomainClassProperty.BELONGS_TO) || name.equals(GrailsDomainClassProperty.HAS_ONE);
    if (isBelongsTo) {
      Expression e=pn.getInitialExpression();
      propertiesToAdd.addAll(createPropertiesForBelongsToExpression(e,classNode));
    }
  }
  injectAssociationProperties(classNode,propertiesToAdd);
}
