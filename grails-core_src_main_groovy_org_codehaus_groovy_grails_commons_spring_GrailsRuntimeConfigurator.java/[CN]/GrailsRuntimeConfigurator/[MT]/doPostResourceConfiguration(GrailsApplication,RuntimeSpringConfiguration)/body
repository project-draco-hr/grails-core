{
  ClassLoader classLoader=Thread.currentThread().getContextClassLoader();
  String resourceName=null;
  try {
    Resource springResources;
    if (app.isWarDeployed()) {
      resourceName=GrailsRuntimeConfigurator.SPRING_RESOURCES_XML;
      springResources=parent.getResource(resourceName);
    }
 else {
      resourceName=DEVELOPMENT_SPRING_RESOURCES_XML;
      ResourcePatternResolver patternResolver=new PathMatchingResourcePatternResolver();
      springResources=patternResolver.getResource(resourceName);
    }
    if (springResources != null && springResources.exists()) {
      if (LOG.isDebugEnabled())       LOG.debug("[RuntimeConfiguration] Configuring additional beans from " + springResources.getURL());
      DefaultListableBeanFactory xmlBf=new ReloadAwareAutowireCapableBeanFactory();
      new XmlBeanDefinitionReader(xmlBf).loadBeanDefinitions(springResources);
      xmlBf.setBeanClassLoader(classLoader);
      String[] beanNames=xmlBf.getBeanDefinitionNames();
      if (LOG.isDebugEnabled())       LOG.debug("[RuntimeConfiguration] Found [" + beanNames.length + "] beans to configure");
      for (      String beanName : beanNames) {
        BeanDefinition bd=xmlBf.getBeanDefinition(beanName);
        final String beanClassName=bd.getBeanClassName();
        Class<?> beanClass=beanClassName == null ? null : ClassUtils.forName(beanClassName,classLoader);
        springConfig.addBeanDefinition(beanName,bd);
        String[] aliases=xmlBf.getAliases(beanName);
        for (        String alias : aliases) {
          springConfig.addAlias(alias,beanName);
        }
        if (beanClass != null) {
          if (BeanFactoryPostProcessor.class.isAssignableFrom(beanClass)) {
            ((ConfigurableApplicationContext)springConfig.getUnrefreshedApplicationContext()).addBeanFactoryPostProcessor((BeanFactoryPostProcessor)xmlBf.getBean(beanName));
          }
        }
      }
    }
 else     if (LOG.isDebugEnabled()) {
      LOG.debug("[RuntimeConfiguration] " + resourceName + " not found. Skipping configuration.");
    }
  }
 catch (  Exception ex) {
    LOG.error("[RuntimeConfiguration] Unable to perform post initialization config: " + resourceName,ex);
  }
  GrailsRuntimeConfigurator.loadSpringGroovyResources(springConfig,app);
}
