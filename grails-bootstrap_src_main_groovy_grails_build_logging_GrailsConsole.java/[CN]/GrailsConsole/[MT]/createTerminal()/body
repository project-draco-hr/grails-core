{
  Terminal terminal;
  if (isWindows()) {
    terminal=new WindowsTerminal(){
      @Override public boolean isANSISupported(){
        return true;
      }
    }
;
    try {
      terminal.initializeTerminal();
      terminal.enableEcho();
      fixCtrlC();
    }
 catch (    Exception e) {
      terminal=new UnsupportedTerminal();
    }
  }
 else {
    terminal=Terminal.setupTerminal();
  }
  return terminal;
}
