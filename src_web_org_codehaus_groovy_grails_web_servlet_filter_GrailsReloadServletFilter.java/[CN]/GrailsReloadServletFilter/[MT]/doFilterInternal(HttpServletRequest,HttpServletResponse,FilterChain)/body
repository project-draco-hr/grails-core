{
  if (LOG.isDebugEnabled()) {
    LOG.debug("Executing Grails reload filter...");
  }
  try {
    GrailsApplication application=(GrailsApplication)context.getBean(GrailsApplication.APPLICATION_ID);
    GrailsPluginManager manager=PluginManagerHolder.getPluginManager();
    if (manager != null) {
      LOG.debug("Checking Plugin manager for changes..");
      manager.checkForChanges();
      if (!application.isInitialised()) {
        application.rebuild();
        GrailsRuntimeConfigurator config=new GrailsRuntimeConfigurator(application,parent);
        config.reconfigure(context,getServletContext(),true);
      }
    }
 else {
      LOG.debug("Plugin manager not found, skipping change check");
    }
  }
 catch (  Exception e) {
    GrailsUtil.deepSanitize(e);
    LOG.error("Error occured reloading application: " + e.getMessage(),e);
    httpServletResponse.setStatus(HttpServletResponse.SC_INTERNAL_SERVER_ERROR);
    GroovyPagesTemplateEngine engine=appAttributes.getPagesTemplateEngine();
    Template t=engine.createTemplate(GrailsApplicationAttributes.PATH_TO_VIEWS + "/error.gsp");
    GrailsWrappedRuntimeException wrapped=new GrailsWrappedRuntimeException(getServletContext(),e);
    Map model=new HashMap();
    model.put("exception",wrapped);
    Writable w=t.make(model);
    Writer out=createResponseWriter(httpServletResponse);
    w.writeTo(out);
    return;
  }
  filterChain.doFilter(httpServletRequest,httpServletResponse);
}
