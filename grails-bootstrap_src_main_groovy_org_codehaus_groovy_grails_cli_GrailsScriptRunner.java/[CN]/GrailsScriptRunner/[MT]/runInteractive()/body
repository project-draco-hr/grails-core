{
  out.println("\n--------------------------------------------------------");
  out.println("Interactive mode ready. Enter a Grails command or type \"exit\" to quit interactive mode (hit ENTER to run the last command)");
  String prompt="> ";
  System.setProperty("grails.disable.exit","true");
  System.setProperty("grails.interactive.mode","true");
  ScriptAndArgs script=new ScriptAndArgs();
  String env=null;
  while (true) {
    System.clearProperty("grails.env.set");
    System.clearProperty(Environment.KEY);
    String enteredName=helper.userInput(prompt);
    if (enteredName != null && enteredName.trim().length() > 0) {
      script=processAndReturnArguments(enteredName.split(" "));
      if (script.args != null) {
        System.setProperty("grails.cli.args",script.args);
      }
 else {
        System.setProperty("grails.cli.args","");
      }
      env=script.env != null ? script.env : Environment.DEVELOPMENT.getName();
    }
    if (script.name == null) {
      out.println("You must enter a command.\n");
      continue;
    }
 else     if (script.name.equalsIgnoreCase("exit") || script.name.equalsIgnoreCase("quit")) {
      return;
    }
    long now=System.currentTimeMillis();
    try {
      callPluginOrGrailsScript(script.name,env);
    }
 catch (    ScriptNotFoundException ex) {
      out.println("No script found for " + script.name);
    }
catch (    Throwable ex) {
      if (ex.getCause() instanceof ScriptExitException) {
        out.println("Script exited with code " + ((ScriptExitException)ex.getCause()).getExitCode());
      }
 else {
        out.println("Script threw exception");
        ex.printStackTrace(out);
      }
    }
    long end=System.currentTimeMillis();
    out.println("\n---- Command completed in " + (end - now) + "ms");
  }
}
