{
  evaluateMapping(sub);
  Mapping m=getMapping(parent.getMappedClass());
  Subclass subClass;
  boolean tablePerSubclass=m != null && !m.getTablePerHierarchy();
  if (tablePerSubclass) {
    subClass=new JoinedSubclass(parent);
  }
 else {
    subClass=new SingleTableSubclass(parent);
    Mapping subMapping=getMapping(sub);
    subClass.setDiscriminatorValue(subMapping != null && subMapping.getDiscriminator() != null ? subMapping.getDiscriminator() : sub.getFullName());
  }
  subClass.setEntityName(sub.getFullName());
  parent.addSubclass(subClass);
  mappings.addClass(subClass);
  if (tablePerSubclass) {
    bindJoinedSubClass(sub,(JoinedSubclass)subClass,mappings,m);
  }
 else {
    bindSubClass(sub,subClass,mappings);
  }
  if (!sub.getSubClasses().isEmpty()) {
    bindSubClasses(sub,subClass,mappings);
  }
}
