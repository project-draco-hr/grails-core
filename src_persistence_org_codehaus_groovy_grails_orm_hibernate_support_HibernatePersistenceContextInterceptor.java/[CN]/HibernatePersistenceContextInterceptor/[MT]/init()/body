{
  if (TransactionSynchronizationManager.hasResource(sessionFactory)) {
    participate=true;
  }
 else {
    LOG.debug("Opening single Hibernate session in HibernatePersistenceContextInterceptor");
    Session session=SessionFactoryUtils.getSession(sessionFactory,true);
    session.setFlushMode(FlushMode.AUTO);
    TransactionSynchronizationManager.bindResource(sessionFactory,new SessionHolder(session));
  }
}
