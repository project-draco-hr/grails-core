{
  WebApplicationContext parent=WebApplicationContextUtils.getRequiredWebApplicationContext(getServletContext());
  ApplicationContext context=(ApplicationContext)getServletContext().getAttribute(GrailsApplicationAttributes.APPLICATION_CONTEXT);
  if (context != null) {
    return (SessionFactory)context.getBean(getSessionFactoryBeanName(),SessionFactory.class);
  }
  return null;
}
