{
  GroovyClassLoader gcl=new GroovyClassLoader();
  Class dc=gcl.parseClass("class Test { Long id; Long version; }");
  Class c=gcl.parseClass("class TestController { def scaffold = Test }");
  GrailsApplication app=new DefaultGrailsApplication(new Class[]{dc,c},gcl);
  MockApplicationContext parent=new MockApplicationContext();
  parent.registerMockBean(GrailsApplication.APPLICATION_ID,app);
  GrailsRuntimeConfigurator conf=new GrailsRuntimeConfigurator(app,parent);
  ApplicationContext ctx=conf.configure(new MockServletContext());
  assertNotNull(ctx);
  HotSwappableTargetSource ts=(HotSwappableTargetSource)ctx.getBean("TestControllerTargetSource");
  GrailsControllerClass gcc=(GrailsControllerClass)ts.getTarget();
  assertTrue(gcc.isScaffolding());
}
