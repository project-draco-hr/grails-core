{
  StringWriter sw=new StringWriter();
  PrintWriter pw=new PrintWriter(sw);
  Closure tag=getTag("remoteFunction",pw);
  GroovyObject tagLibrary=(GroovyObject)tag.getOwner();
  GrailsHttpServletRequest request=(GrailsHttpServletRequest)tagLibrary.getProperty("request");
  List includedLibrary=new ArrayList();
  includedLibrary.add("yahoo");
  request.setAttribute("org.codehaus.grails.INCLUDED_JS_LIBRARIES",includedLibrary);
  Map attrs=new HashMap();
  attrs.put("action","action");
  attrs.put("controller","test");
  tag.call(new Object[]{attrs});
  System.out.println(sw.toString());
  assertEquals("YAHOO.util.Connect.asyncRequest('GET','/test/action',{ },null);",sw.toString());
  attrs.put("action","action");
  attrs.put("controller","test");
  Map update=new HashMap();
  update.put("success","updateMe");
  attrs.put("update",update);
  sw.getBuffer().delete(0,sw.getBuffer().length());
  tag.call(new Object[]{attrs});
  System.out.println(sw.toString());
  assertEquals("YAHOO.util.Connect.asyncRequest('GET','/test/action',{ success: function(o) { YAHOO.util.Dom.get('updateMe').innerHTML = o.responseText; }, failure: function(o) {}},null);",sw.toString());
}
