{
  UrlPathHelper pathHelper=new UrlPathHelper();
  if (request.getRequestURI().endsWith(DISPATCH_URI_SUFFIX)) {
    String path=pathHelper.getPathWithinApplication(request);
    if (path.startsWith(GRAILS_DISPATCH_SERVLET_NAME)) {
      path=path.substring(GRAILS_DISPATCH_SERVLET_NAME.length(),path.length());
    }
    return path.substring(0,path.length() - DISPATCH_URI_SUFFIX.length());
  }
 else {
    return pathHelper.getPathWithinApplication(request);
  }
}
