{
  if (artefactInfo == null) {
    return null;
  }
  String uri=null;
  String pluginName=null;
  if (featureId instanceof Map) {
    Map featureIdMap=(Map)featureId;
    uri=(String)featureIdMap.get("uri");
    pluginName=(String)featureIdMap.get("pluginName");
  }
 else {
    uri=featureId.toString();
  }
  GrailsClass controllerClass=uriToControllerClassCache.get(uri);
  if (controllerClass == null) {
    final GrailsClass[] controllerClasses=artefactInfo.getGrailsClasses();
    for (int i=(controllerClasses.length - 1); i >= 0; i--) {
      GrailsClass c=controllerClasses[i];
      if (((GrailsControllerClass)c).mapsToURI(uri)) {
        boolean foundController=false;
        if (pluginName != null) {
          Object bean=grailsApplication.getMainContext().getBean("pluginManager");
          if (bean instanceof GrailsPluginManager) {
            GrailsPluginManager gpm=(GrailsPluginManager)bean;
            GrailsPlugin pluginForClass=gpm.getPluginForClass(c.getClazz());
            if (pluginForClass != null && pluginName.equals(pluginForClass.getName())) {
              foundController=true;
            }
          }
        }
 else {
          foundController=true;
        }
        if (foundController) {
          controllerClass=c;
          break;
        }
      }
    }
    if (controllerClass == null) {
      controllerClass=NO_CONTROLLER;
    }
    if (Environment.getCurrent() != Environment.DEVELOPMENT) {
      uriToControllerClassCache.put(uri,controllerClass);
    }
  }
  if (controllerClass == NO_CONTROLLER) {
    controllerClass=null;
  }
  return controllerClass;
}
