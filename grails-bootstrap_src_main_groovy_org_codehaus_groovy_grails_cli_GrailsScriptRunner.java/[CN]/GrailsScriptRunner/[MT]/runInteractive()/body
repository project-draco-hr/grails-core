{
  String message="Interactive mode ready. Enter a Grails command or type \"exit\" to quit interactive mode (hit ENTER to run the last command):\n";
  System.setProperty("grails.disable.exit","true");
  System.setProperty("grails.interactive.mode","true");
  ScriptAndArgs script=new ScriptAndArgs();
  String env=null;
  while (true) {
    System.clearProperty("grails.env.set");
    System.clearProperty(Environment.KEY);
    consoleOut.println("--------------------------------------------------------");
    String enteredName=helper.userInput(message);
    if (enteredName != null && enteredName.trim().length() > 0) {
      script=processArgumentsAndReturnScriptName(enteredName);
      if (script.args != null) {
        System.setProperty("grails.cli.args",script.args);
      }
 else {
        System.setProperty("grails.cli.args","");
      }
      env=script.env != null ? script.env : Environment.DEVELOPMENT.getName();
    }
    if (script.name == null) {
      consoleOut.println("You must enter a command.\n");
      continue;
    }
 else     if (script.name.equalsIgnoreCase("exit") || script.name.equalsIgnoreCase("quit")) {
      return;
    }
    long now=System.currentTimeMillis();
    try {
      callPluginOrGrailsScript(script.name,env);
    }
 catch (    ScriptNotFoundException ex) {
      consoleOut.println("No script found for " + script.name);
    }
catch (    Throwable ex) {
      if (ex.getCause() instanceof ScriptExitException) {
        consoleOut.println("Script exited with code " + ((ScriptExitException)ex.getCause()).getExitCode());
      }
 else {
        consoleOut.println("Script threw exception");
        ex.printStackTrace(out);
      }
    }
    long end=System.currentTimeMillis();
    consoleOut.println("--------------------------------------------------------");
    consoleOut.println("Command " + script.name + " completed in "+ (end - now)+ "ms");
  }
}
