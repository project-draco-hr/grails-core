{
  String responsesString=null;
  if (validResponses != null) {
    responsesString=DefaultGroovyMethods.join(validResponses,",");
  }
  BufferedReader reader=new BufferedReader(new InputStreamReader(System.in));
  for (int it=0; it < 3; it++) {
    showInputMessage(message,responsesString);
    try {
      String line=reader.readLine();
      if (validResponses == null)       return line;
      for (      String validResponse : validResponses) {
        if (line != null && line.equalsIgnoreCase(validResponse)) {
          return line;
        }
      }
      printMessage("Invalid option '" + line + "' - must be one of: ["+ responsesString+ "]");
    }
 catch (    IOException ex) {
      printMessage("ERROR: Could not read System.in due to:" + ex.getMessage());
      return null;
    }
  }
  printMessage("No valid response entered - giving up asking.");
  return null;
}
