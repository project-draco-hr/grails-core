{
  Object controllerName;
  Object actionName;
  final Map bindingVariables=binding != null ? binding.getVariables() : null;
  controllerName=getControllerName(namedArguments,bindingVariables);
  actionName=getActionName(namedArguments,bindingVariables);
  Object pluginName=getPluginName(namedArguments,bindingVariables);
  Object httpMethod=getHttpMethod(namedArguments,bindingVariables);
  Object controllerNamespace=getControllerNamespace(namedArguments,bindingVariables);
  Object viewName=getViewName(namedArguments,bindingVariables);
  if (actionName != null && viewName != null) {
    viewName=null;
    LOG.warn("Both [action] and [view] specified in URL mapping [" + mapping + "]. The action takes precendence!");
  }
  Object uri=getURI(namedArguments,bindingVariables);
  ConstrainedProperty[] constraints=getCurrentConstraints().toArray(new ConstrainedProperty[getCurrentConstraints().size()]);
  UrlMapping urlMapping;
  if (uri != null) {
    try {
      urlMapping=new RegexUrlMapping(urlData,new URI(uri.toString()),constraints,sc);
    }
 catch (    URISyntaxException e) {
      throw new UrlMappingException("Cannot map to invalid URI: " + e.getMessage(),e);
    }
  }
 else {
    urlMapping=createURLMapping(urlData,isResponseCode,controllerName,actionName,controllerNamespace,pluginName,viewName,httpMethod != null ? httpMethod.toString() : null,constraints);
  }
  Object exceptionArg=getException(namedArguments,bindingVariables);
  if (isResponseCode && exceptionArg != null) {
    if (exceptionArg instanceof Class) {
      Class exClass=(Class)exceptionArg;
      if (Throwable.class.isAssignableFrom(exClass)) {
        ((ResponseCodeUrlMapping)urlMapping).setExceptionType(exClass);
      }
 else {
        LOG.error("URL mapping argument [exception] with value [" + exceptionArg + "] must be a subclass of java.lang.Throwable");
      }
    }
 else {
      LOG.error("URL mapping argument [exception] with value [" + exceptionArg + "] must be a valid class");
    }
  }
  Object parseRequest=getParseRequest(namedArguments,bindingVariables);
  if (parseRequest instanceof Boolean) {
    urlMapping.setParseRequest((Boolean)parseRequest);
  }
  return urlMapping;
}
