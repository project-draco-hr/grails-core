{
  for (  PropertyValue pv : mpvs.getPropertyValues()) {
    String propertyName=pv.getName();
    if (!isAllowed(propertyName))     continue;
    String propertyNameToCheck=propertyName;
    final int i=propertyName.indexOf('.');
    if (i > -1) {
      propertyNameToCheck=propertyName.substring(0,i);
    }
    if (!isAllowed(propertyNameToCheck))     continue;
    if (propertyName.endsWith(IDENTIFIER_SUFFIX)) {
      propertyName=propertyName.substring(0,propertyName.length() - 3);
      if (!isAllowed(propertyName))       continue;
      if (isReadableAndPersistent(propertyName) && bean.isWritableProperty(propertyName)) {
        if (NULL_ASSOCIATION.equals(pv.getValue())) {
          bean.setPropertyValue(propertyName,null);
          mpvs.removePropertyValue(pv);
        }
 else {
          Class<?> type=getPropertyTypeForPath(propertyName);
          final Object persisted=getPersistentInstance(type,pv.getValue());
          if (persisted != null) {
            bean.setPropertyValue(propertyName,persisted);
            if (domainClass != null) {
              GrailsDomainClassProperty property=domainClass.getPersistentProperty(propertyName);
              if (property != null) {
                final GrailsDomainClassProperty otherSide=property.getOtherSide();
                if (otherSide != null && List.class.isAssignableFrom(otherSide.getType()) && !property.isOptional()) {
                  DeferredBindingActions.addBindingAction(new Runnable(){
                    public void run(){
                      if (otherSide.isOneToMany()) {
                        String methodName="addTo" + GrailsNameUtils.getClassName(otherSide.getName());
                        GrailsMetaClassUtils.invokeMethodIfExists(persisted,methodName,new Object[]{getTarget()});
                      }
                    }
                  }
);
                }
              }
            }
          }
        }
      }
    }
 else {
      if (isReadableAndPersistent(propertyName)) {
        Class<?> type=getPropertyTypeForPath(propertyName);
        if (type != null) {
          if (Collection.class.isAssignableFrom(type)) {
            bindCollectionAssociation(mpvs,pv);
          }
        }
      }
    }
  }
}
