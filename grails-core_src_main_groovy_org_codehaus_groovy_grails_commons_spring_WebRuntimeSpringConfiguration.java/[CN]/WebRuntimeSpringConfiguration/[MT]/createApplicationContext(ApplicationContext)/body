{
  if (parentCtx != null && beanFactory != null) {
    Assert.isInstanceOf(DefaultListableBeanFactory.class,beanFactory,"ListableBeanFactory set must be a subclass of DefaultListableBeanFactory");
    return new GrailsWebApplicationContext((DefaultListableBeanFactory)beanFactory,parentCtx);
  }
  if (beanFactory != null) {
    Assert.isInstanceOf(DefaultListableBeanFactory.class,beanFactory,"ListableBeanFactory set must be a subclass of DefaultListableBeanFactory");
    return new GrailsWebApplicationContext((DefaultListableBeanFactory)beanFactory);
  }
  if (parentCtx != null) {
    return new GrailsWebApplicationContext(parentCtx);
  }
  return new GrailsWebApplicationContext();
}
