{
  String viewName=argMap.get(ARGUMENT_VIEW).toString();
  String viewUri=webRequest.getAttributes().getNoSuffixViewURI((GroovyObject)target,viewName);
  Object modelObject=argMap.get(ARGUMENT_MODEL);
  if (modelObject != null) {
    modelObject=argMap.get(ARGUMENT_MODEL);
    boolean isPromise=modelObject instanceof Promise;
    Collection<ActionResultTransformer> resultTransformers=getActionResultTransformers(webRequest);
    for (    ActionResultTransformer resultTransformer : resultTransformers) {
      modelObject=resultTransformer.transformActionResult(webRequest,viewUri,modelObject);
    }
    if (isPromise)     return;
  }
  applyContentType(webRequest.getCurrentResponse(),argMap,null);
  Map model;
  if (modelObject instanceof Map) {
    model=(Map)modelObject;
  }
 else   if (target instanceof GroovyObject) {
    model=new BeanMap(target);
  }
 else {
    model=new HashMap();
  }
  controller.setProperty(ControllerDynamicMethods.MODEL_AND_VIEW_PROPERTY,new ModelAndView(viewUri,model));
}
