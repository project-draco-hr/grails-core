{
  if (grailsApplication == null)   throw new IllegalStateException("Property [grailsApplication] must be set!");
  List urlMappings=new ArrayList();
  List excludePatterns=new ArrayList();
  GrailsClass[] mappings=grailsApplication.getArtefacts(UrlMappingsArtefactHandler.TYPE);
  this.mappingEvaluator=new DefaultUrlMappingEvaluator(servletContext);
  for (int i=0; i < mappings.length; i++) {
    GrailsUrlMappingsClass mappingClass=(GrailsUrlMappingsClass)mappings[i];
    List grailsClassMappings;
    if (Script.class.isAssignableFrom(mappingClass.getClass())) {
      grailsClassMappings=mappingEvaluator.evaluateMappings(mappingClass.getClazz());
    }
 else {
      grailsClassMappings=mappingEvaluator.evaluateMappings(mappingClass.getMappingsClosure());
    }
    urlMappings.addAll(grailsClassMappings);
    if (mappingClass.getExcludePatterns() != null)     excludePatterns.addAll(mappingClass.getExcludePatterns());
  }
  this.urlMappingsHolder=new DefaultUrlMappingsHolder(urlMappings,excludePatterns);
}
