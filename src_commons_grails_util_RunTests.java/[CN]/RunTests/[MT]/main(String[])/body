{
  ApplicationContext parent=new ClassPathXmlApplicationContext("applicationContext.xml");
  DefaultGrailsApplication application=(DefaultGrailsApplication)parent.getBean("grailsApplication",DefaultGrailsApplication.class);
  SpringConfig config=new SpringConfig(application);
  ConfigurableApplicationContext appCtx=(ConfigurableApplicationContext)new XmlApplicationContextDriver().getApplicationContext(config.getBeanReferences(),parent);
  Class[] allClasses=application.getAllClasses();
  log.debug("Going through [" + allClasses.length + "] classes");
  TestSuite s=new TestSuite();
  for (int i=0; i < allClasses.length; i++) {
    Class clazz=allClasses[i];
    if (TestCase.class.isAssignableFrom(clazz) && !Modifier.isAbstract(clazz.getModifiers())) {
      log.debug("Adding test [" + clazz.getName() + "]");
      s.addTest(new GrailsTestSuite(appCtx.getBeanFactory(),clazz));
    }
 else {
      log.debug("[" + clazz.getName() + "] is not a test case.");
    }
  }
  TestRunner.run(s);
}
