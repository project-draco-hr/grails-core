{
  if (res == null) {
    return generateTemplateName();
  }
  String name;
  try {
    name=pageName != null ? pageName : res.getURL().getPath();
    name=name.substring(1).replaceAll("[^\\w\\d]","_");
  }
 catch (  IllegalStateException e) {
    name=generateTemplateName();
  }
catch (  IOException ioex) {
    name=generateTemplateName();
  }
  return name;
}
