{
  try {
    GrailsApplication grailsApplication=GrailsWebUtil.lookupApplication(event.getServletContext());
    ConfigObject co=grailsApplication != null ? grailsApplication.getConfig() : null;
    if (co == null) {
      GrailsApplication application=new DefaultGrailsApplication();
      try {
        ApplicationHolder.setApplication(application);
        co=ConfigurationHelper.loadConfigFromClasspath(application);
      }
  finally {
        ApplicationHolder.setApplication(null);
      }
      Object o=co.get("log4j");
      if (o instanceof Closure) {
        new Log4jConfig().configure((Closure)o);
      }
 else {
        new Log4jConfig().configure();
      }
    }
  }
 catch (  Throwable e) {
    LogLog.error("Error initializing log4j: " + e.getMessage(),e);
  }
}
