{
  this.metaInfo=metaInfo;
  this.allowSettingContentType=allowSettingContentType;
  webRequest=(GrailsWebRequest)RequestContextHolder.getRequestAttributes();
  if (webRequest != null) {
    request=webRequest.getCurrentRequest();
    HttpServletResponse wrapped=WrappedResponseHolder.getWrappedResponse();
    response=wrapped != null ? wrapped : webRequest.getCurrentResponse();
  }
  showSource=shouldShowGroovySource();
  debugTemplates=shouldDebugTemplates();
  if (debugTemplates) {
    debugTemplatesIdCounter=(AtomicInteger)request.getAttribute(ATTRIBUTE_NAME_DEBUG_TEMPLATES_ID_COUNTER);
    if (debugTemplatesIdCounter == null) {
      debugTemplatesIdCounter=new AtomicInteger(0);
      request.setAttribute(ATTRIBUTE_NAME_DEBUG_TEMPLATES_ID_COUNTER,debugTemplatesIdCounter);
    }
  }
}
