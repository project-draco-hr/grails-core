{
  if (target instanceof Encodeable) {
    return ((Encodeable)target).encode(this);
  }
  EncodingState encodingState=lookupEncodingState();
  if (encodingState != null && target instanceof CharSequence) {
    Set<String> tags=encodingState.getEncodingTagsFor((CharSequence)target);
    if (tags != null && tags.contains(getCodecName())) {
      return (CharSequence)target;
    }
  }
  Object encoded=delegate.encode(target);
  if (encodingState != null && encoded instanceof CharSequence)   encodingState.registerEncodedWith(this,(CharSequence)encoded);
  return encoded;
}
