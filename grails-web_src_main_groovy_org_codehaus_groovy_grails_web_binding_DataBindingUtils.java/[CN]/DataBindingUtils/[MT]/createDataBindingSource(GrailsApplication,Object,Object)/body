{
  DataBindingSourceRegistry registry=null;
  MimeTypeResolver mimeTypeResolver=null;
  if (grailsApplication != null) {
    ApplicationContext context=grailsApplication.getMainContext();
    if (context != null) {
      if (context.containsBean(DataBindingSourceRegistry.BEAN_NAME)) {
        registry=context.getBean(DataBindingSourceRegistry.BEAN_NAME,DataBindingSourceRegistry.class);
      }
      if (context.containsBean(MimeTypeResolver.BEAN_NAME)) {
        mimeTypeResolver=context.getBean(MimeTypeResolver.BEAN_NAME,MimeTypeResolver.class);
      }
    }
  }
  if (registry == null) {
    registry=new DefaultDataBindingSourceRegistry();
  }
  final MimeType mimeType;
  if (mimeTypeResolver != null) {
    mimeType=mimeTypeResolver.resolveRequestMimeType();
  }
 else   if (bindingSource instanceof HttpServletRequest) {
    HttpServletRequest req=(HttpServletRequest)bindingSource;
    String contentType=req.getContentType();
    if (contentType != null) {
      mimeType=new MimeType(contentType);
    }
 else {
      mimeType=MimeType.ALL;
    }
  }
 else {
    mimeType=MimeType.ALL;
  }
  return registry.createDataBindingSource(mimeType,bindingTarget,bindingSource);
}
