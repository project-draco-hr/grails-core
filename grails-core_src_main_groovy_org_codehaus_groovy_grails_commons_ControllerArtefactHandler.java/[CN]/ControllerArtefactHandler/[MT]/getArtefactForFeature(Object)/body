{
  if (artefactInfo == null) {
    return null;
  }
  String uri;
  String pluginName=null;
  String namespace=null;
  if (featureId instanceof Map) {
    Map featureIdMap=(Map)featureId;
    uri=(String)featureIdMap.get("uri");
    pluginName=(String)featureIdMap.get("pluginName");
    namespace=(String)featureIdMap.get("namespace");
  }
 else {
    uri=featureId.toString();
  }
  String cacheKey=(namespace != null ? namespace : "") + ":" + (pluginName != null ? pluginName : "")+ ":"+ uri;
  GrailsClass controllerClass=uriToControllerClassCache.get(cacheKey);
  if (controllerClass == null) {
    final ApplicationContext mainContext=grailsApplication.getMainContext();
    GrailsPluginManager grailsPluginManager=null;
    if (mainContext.containsBean(GrailsPluginManager.BEAN_NAME)) {
      final Object pluginManagerBean=mainContext.getBean(GrailsPluginManager.BEAN_NAME);
      if (pluginManagerBean instanceof GrailsPluginManager) {
        grailsPluginManager=(GrailsPluginManager)pluginManagerBean;
      }
    }
    final GrailsClass[] controllerClasses=artefactInfo.getGrailsClasses();
    for (int i=(controllerClasses.length - 1); i >= 0; i--) {
      GrailsClass c=controllerClasses[i];
      if (((GrailsControllerClass)c).mapsToURI(uri)) {
        boolean pluginMatches=false;
        boolean namespaceMatches=false;
        namespaceMatches=namespaceMatches((GrailsControllerClass)c,namespace);
        if (namespaceMatches) {
          pluginMatches=pluginMatches(c,pluginName,grailsPluginManager);
        }
        boolean foundController=pluginMatches && namespaceMatches;
        if (foundController) {
          controllerClass=c;
          break;
        }
      }
    }
    if (controllerClass == null) {
      controllerClass=NO_CONTROLLER;
    }
    if (Environment.getCurrent() != Environment.DEVELOPMENT) {
      uriToControllerClassCache.put(cacheKey,controllerClass);
    }
  }
  if (controllerClass == NO_CONTROLLER) {
    controllerClass=null;
  }
  return controllerClass;
}
