{
  if (timeout < 0 || updater == null)   return valueRef.get();
  if (System.currentTimeMillis() - timeout > createdMillis) {
    try {
      long beforeLockingCreatedMillis=createdMillis;
      writeLock.lock();
      if (beforeLockingCreatedMillis == createdMillis || createdMillis == 0L) {
        valueRef.set(updater.run());
        resetTimestamp();
      }
    }
  finally {
      writeLock.unlock();
    }
  }
  return valueRef.get();
}
