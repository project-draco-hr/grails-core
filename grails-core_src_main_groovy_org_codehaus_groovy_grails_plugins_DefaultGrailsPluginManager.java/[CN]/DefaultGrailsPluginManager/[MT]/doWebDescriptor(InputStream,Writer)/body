{
  checkInitialised();
  try {
    Document document=DOMBuilder.parse(new InputStreamReader(inputStream,"UTF-8"));
    Element documentElement=document.getDocumentElement();
    for (    GrailsPlugin plugin : pluginList) {
      if (plugin.supportsCurrentScopeAndEnvironment()) {
        plugin.doWithWebDescriptor(documentElement);
      }
    }
    boolean areServlet3JarsPresent=ClassUtils.isPresent("javax.servlet.AsyncContext",Thread.currentThread().getContextClassLoader());
    String servletVersion=application.getMetadata().getServletVersion();
    if (areServlet3JarsPresent && GrailsVersionUtils.supportsAtLeastVersion(servletVersion,"3.0")) {
      new Servlet3AsyncWebXmlProcessor().process(documentElement);
    }
    writeWebDescriptorResult(documentElement,target);
  }
 catch (  ParserConfigurationException e) {
    throw new PluginException("Unable to configure web.xml due to parser configuration problem: " + e.getMessage(),e);
  }
catch (  SAXException e) {
    throw new PluginException("XML parsing error configuring web.xml: " + e.getMessage(),e);
  }
catch (  IOException e) {
    throw new PluginException("Unable to read web.xml" + e.getMessage(),e);
  }
}
