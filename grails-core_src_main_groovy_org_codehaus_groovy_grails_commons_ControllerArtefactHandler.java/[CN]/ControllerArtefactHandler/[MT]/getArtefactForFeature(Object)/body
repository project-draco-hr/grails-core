{
  if (artefactInfo == null) {
    return null;
  }
  String uri;
  String pluginName=null;
  String controllerNamespace=null;
  if (featureId instanceof Map) {
    Map featureIdMap=(Map)featureId;
    uri=(String)featureIdMap.get("uri");
    pluginName=(String)featureIdMap.get("pluginName");
    controllerNamespace=(String)featureIdMap.get("controllerNamespace");
  }
 else {
    uri=featureId.toString();
  }
  String cacheKey=(controllerNamespace != null ? controllerNamespace : "") + ":" + (pluginName != null ? pluginName : "")+ ":"+ uri;
  GrailsClass controllerClass=uriToControllerClassCache.get(cacheKey);
  if (controllerClass == null) {
    final ApplicationContext mainContext=grailsApplication.getMainContext();
    GrailsPluginManager grailsPluginManager=null;
    if (mainContext.containsBean(GrailsPluginManager.BEAN_NAME)) {
      final Object pluginManagerBean=mainContext.getBean(GrailsPluginManager.BEAN_NAME);
      if (pluginManagerBean instanceof GrailsPluginManager) {
        grailsPluginManager=(GrailsPluginManager)pluginManagerBean;
      }
    }
    final GrailsClass[] controllerClasses=artefactInfo.getGrailsClasses();
    for (int i=(controllerClasses.length - 1); i >= 0; i--) {
      GrailsClass c=controllerClasses[i];
      if (((GrailsControllerClass)c).mapsToURI(uri)) {
        boolean foundController=false;
        if (pluginName == null && controllerNamespace == null) {
          foundController=true;
        }
 else {
          boolean pluginMatches=false;
          boolean controllerNamespaceMatches=false;
          controllerNamespaceMatches=namespaceMatches((GrailsControllerClass)c,controllerNamespace);
          if (controllerNamespaceMatches) {
            pluginMatches=pluginMatches(c,pluginName,grailsPluginManager);
          }
          foundController=pluginMatches && controllerNamespaceMatches;
        }
        if (foundController) {
          controllerClass=c;
          break;
        }
      }
    }
    if (controllerClass == null) {
      controllerClass=NO_CONTROLLER;
    }
    if (Environment.getCurrent() != Environment.DEVELOPMENT) {
      uriToControllerClassCache.put(cacheKey,controllerClass);
    }
  }
  if (controllerClass == NO_CONTROLLER) {
    controllerClass=null;
  }
  return controllerClass;
}
