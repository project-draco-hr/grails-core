{
  if (parentCtx != null && beanFactory != null) {
    if (beanFactory instanceof DefaultListableBeanFactory) {
      return new GrailsWebApplicationContext((DefaultListableBeanFactory)beanFactory,parentCtx);
    }
    throw new IllegalArgumentException("ListableBeanFactory set must be a subclass of DefaultListableBeanFactory");
  }
  if (beanFactory != null) {
    if (beanFactory instanceof DefaultListableBeanFactory) {
      return new GrailsWebApplicationContext((DefaultListableBeanFactory)beanFactory);
    }
    throw new IllegalArgumentException("ListableBeanFactory set must be a subclass of DefaultListableBeanFactory");
  }
  if (parentCtx != null) {
    return new GrailsWebApplicationContext(parentCtx);
  }
  return new GrailsWebApplicationContext();
}
