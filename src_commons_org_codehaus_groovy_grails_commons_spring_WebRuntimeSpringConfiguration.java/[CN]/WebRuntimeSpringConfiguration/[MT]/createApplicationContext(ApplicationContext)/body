{
  if (parent != null && beanFactory != null) {
    if (beanFactory instanceof DefaultListableBeanFactory) {
      return new GrailsWebApplicationContext((DefaultListableBeanFactory)beanFactory,parent);
    }
 else {
      throw new IllegalArgumentException("ListableBeanFactory set must be a subclass of DefaultListableBeanFactory");
    }
  }
 else   if (beanFactory != null) {
    if (beanFactory instanceof DefaultListableBeanFactory) {
      return new GrailsWebApplicationContext((DefaultListableBeanFactory)beanFactory);
    }
 else {
      throw new IllegalArgumentException("ListableBeanFactory set must be a subclass of DefaultListableBeanFactory");
    }
  }
 else {
    return new GrailsWebApplicationContext();
  }
}
