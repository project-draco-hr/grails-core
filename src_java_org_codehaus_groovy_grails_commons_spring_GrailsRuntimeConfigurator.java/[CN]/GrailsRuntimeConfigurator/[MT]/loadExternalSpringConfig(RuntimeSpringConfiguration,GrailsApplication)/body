{
  if (springGroovyResourcesBeanBuilder == null) {
    try {
      Class<?> groovySpringResourcesClass=null;
      try {
        groovySpringResourcesClass=ClassUtils.forName(GrailsRuntimeConfigurator.SPRING_RESOURCES_CLASS,application.getClassLoader());
      }
 catch (      ClassNotFoundException e) {
      }
      if (groovySpringResourcesClass != null) {
        springGroovyResourcesBeanBuilder=new BeanBuilder(null,config,Thread.currentThread().getContextClassLoader());
        springGroovyResourcesBeanBuilder.setBinding(new Binding(new HashMap(){
{
            put("application",application);
          }
        }
));
        Script script=(Script)groovySpringResourcesClass.newInstance();
        script.run();
        Object beans=script.getProperty("beans");
        springGroovyResourcesBeanBuilder.beans((Closure)beans);
      }
    }
 catch (    Exception ex) {
      GrailsUtil.deepSanitize(ex);
      LOG.error("[RuntimeConfiguration] Unable to load beans from resources.groovy",ex);
    }
  }
 else {
    if (!springGroovyResourcesBeanBuilder.getSpringConfig().equals(config)) {
      springGroovyResourcesBeanBuilder.registerBeans(config);
    }
  }
}
