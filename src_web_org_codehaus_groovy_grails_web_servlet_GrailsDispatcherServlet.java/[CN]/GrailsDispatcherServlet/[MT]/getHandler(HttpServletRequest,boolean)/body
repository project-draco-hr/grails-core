{
  String uri=urlHelper.getPathWithinApplication(request);
  if (logger.isDebugEnabled()) {
    logger.debug("Looking up Grails controller for URI [" + uri + "]");
  }
  GrailsControllerClass controllerClass=(GrailsControllerClass)application.getArtefactForFeature(ControllerArtefactHandler.TYPE,uri);
  final String actionName=(String)request.getAttribute(GrailsApplicationAttributes.ACTION_NAME_ATTRIBUTE);
  if (controllerClass != null) {
    HandlerInterceptor[] interceptors;
    if (GrailsUtil.isDevelopmentEnv()) {
      interceptors=establishInterceptors(getWebApplicationContext());
    }
 else {
      interceptors=this.interceptors;
    }
    if (controllerClass.isFlowAction(actionName)) {
      FlowHandler flowHandler=new AbstractFlowHandler(){
        public String getFlowId(){
          return actionName;
        }
      }
;
      return new HandlerExecutionChain(flowHandler,interceptors);
    }
 else {
      return new HandlerExecutionChain(mainController,interceptors);
    }
  }
  return null;
}
