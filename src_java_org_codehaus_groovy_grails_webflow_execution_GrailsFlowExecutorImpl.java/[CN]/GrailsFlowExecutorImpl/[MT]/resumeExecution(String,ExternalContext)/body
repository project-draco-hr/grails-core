{
  try {
    ExternalContextHolder.setExternalContext(context);
    FlowExecutionKey key=executionRepository.parseFlowExecutionKey(flowExecutionKey);
    FlowExecution flowExecution=executionRepository.getFlowExecution(key);
    GrailsWebRequest webRequest=WebUtils.retrieveGrailsWebRequest();
    webRequest.getCurrentRequest().setAttribute(ACTIVE_FLOW_ID_ATTRIBUTE,flowExecution.getActiveSession().getDefinition().getId());
    if (isNotValidFlowDefinitionId(flowExecution,webRequest)) {
      return super.launchExecution(webRequest.getControllerName() + "/" + webRequest.getActionName(),context.getRequestMap(),context);
    }
  }
  finally {
    ExternalContextHolder.setExternalContext(null);
  }
  try {
    return super.resumeExecution(flowExecutionKey,context);
  }
 catch (  FlowExecutionRestorationFailureException e) {
    if (e.getCause() instanceof SnapshotUnmarshalException) {
      LOG.info("Classes changed during reload, restarting flow...");
      GrailsWebRequest webRequest=WebUtils.retrieveGrailsWebRequest();
      return super.launchExecution(webRequest.getControllerName() + "/" + webRequest.getActionName(),context.getRequestMap(),context);
    }
    throw e;
  }
}
