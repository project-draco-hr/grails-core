{
  if (node instanceof Proxy) {
    if (resultTransformer != null) {
      this.criteria.setResultTransformer(resultTransformer);
    }
    if (!uniqueResult) {
      if (scroll) {
        resultProxy.setAdaptee(this.criteria.scroll());
      }
 else       if (count) {
        this.criteria.setProjection(Projections.rowCount());
        resultProxy.setAdaptee(this.criteria.uniqueResult());
      }
 else {
        resultProxy.setAdaptee(this.criteria.list());
      }
    }
 else {
      resultProxy.setAdaptee(this.criteria.uniqueResult());
    }
    this.criteria=null;
    if (!this.participate) {
      this.session.close();
    }
  }
 else   if (node.equals(AND) || node.equals(OR) || node.equals(NOT)) {
    LogicalExpression logicalExpression=(LogicalExpression)logicalExpressionStack.pop();
    addToCriteria(logicalExpression.toCriterion());
  }
 else   if (node.equals(PROJECTIONS)) {
    if (this.projectionList != null && this.projectionList.getLength() > 0) {
      this.criteria.setProjection(this.projectionList);
    }
  }
 else   if (targetBean.isReadableProperty(node.toString()) && aliasStack.size() > 0) {
    aliasStack.remove(aliasStack.size() - 1);
    LogicalExpression logicalExpression=(LogicalExpression)logicalExpressionStack.pop();
    if (!logicalExpression.args.isEmpty()) {
      addToCriteria(logicalExpression.toCriterion());
    }
  }
  super.nodeCompleted(parent,node);
}
