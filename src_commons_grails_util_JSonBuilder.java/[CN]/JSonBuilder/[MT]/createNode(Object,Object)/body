{
  if (getCurrent() == null && stack.peek().equals(OBJECT))   throw new IllegalArgumentException(JSON_BUILDER + "only call to [element { }] is allowed when creating array");
  try {
    int retVal=0;
    if (stack.peek().equals(ARRAY)) {
      writeObject();
      retVal=1;
    }
    if (value instanceof Collection) {
      Collection c=(Collection)value;
      writer.key(String.valueOf(key));
      handleCollectionRecurse(c);
    }
 else {
      writer.key(String.valueOf(key)).value(value);
    }
    return retVal != 0 ? Integer.valueOf(retVal) : null;
  }
 catch (  JSONException e) {
    throw new IllegalArgumentException(JSON_BUILDER + "invalid element",e);
  }
}
