{
  GroovyAwareJavassistProxyFactory proxyFactory=new GroovyAwareJavassistProxyFactory();
  @SuppressWarnings("unchecked") Set<Class<?>> proxyInterfaces=new HashSet<Class<?>>(Arrays.asList(HibernateProxy.class));
  final Class<?> javaClass=persistentClass.getMappedClass();
  final Property identifierProperty=persistentClass.getIdentifierProperty();
  final Getter idGetter=identifierProperty != null ? identifierProperty.getGetter(javaClass) : null;
  final Setter idSetter=identifierProperty != null ? identifierProperty.getSetter(javaClass) : null;
  if (idGetter == null || idSetter == null)   return null;
  try {
    proxyFactory.postInstantiate(persistentClass.getEntityName(),javaClass,proxyInterfaces,idGetter.getMethod(),idSetter.getMethod(),persistentClass.hasEmbeddedIdentifier() ? (CompositeType)persistentClass.getIdentifier().getType() : null);
  }
 catch (  HibernateException e) {
    LOG.warn("Cannot instantiate proxy factory: " + e.getMessage());
    return null;
  }
  return proxyFactory;
}
