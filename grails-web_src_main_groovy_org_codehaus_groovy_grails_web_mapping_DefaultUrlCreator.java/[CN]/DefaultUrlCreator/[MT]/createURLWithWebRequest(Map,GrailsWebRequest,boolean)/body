{
  HttpServletRequest request=webRequest.getCurrentRequest();
  String id=null;
  if (parameterValues.containsKey(ARGUMENT_ID)) {
    Object o=parameterValues.get(ARGUMENT_ID);
    if (o != null)     id=o.toString();
  }
  FastStringWriter actualUriBuf=new FastStringWriter();
  if (includeContextPath) {
    actualUriBuf.append(webRequest.getContextPath());
  }
  if (actionName != null) {
    if (actionName.indexOf(SLASH) > -1) {
      actualUriBuf.append(actionName);
    }
 else {
      if (controllerName != null) {
        appendUrlToken(actualUriBuf,controllerName,request);
      }
 else {
        actualUriBuf.append(webRequest.getAttributes().getControllerUri(request));
      }
    }
    appendUrlToken(actualUriBuf,actionName,request);
  }
  if (id != null) {
    appendUrlToken(actualUriBuf,id,request);
  }
  appendRequestParams(actualUriBuf,parameterValues,request);
  return actualUriBuf.toString();
}
