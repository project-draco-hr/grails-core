{
  GroovyObject tagLib=getTagLib(getTagName());
  if (tagLib != null) {
    sw=new StringWriter();
    out=new PrintWriter(sw);
    tagLib.setProperty(TagLibDynamicMethods.OUT_PROPERTY,out);
    Object tagLibProp;
    final Map tagLibProperties=DefaultGroovyMethods.getProperties(tagLib);
    if (tagLibProperties.containsKey(getTagName())) {
      tagLibProp=tagLibProperties.get(getTagName());
    }
 else {
      throw new GrailsTagException("Tag [" + getTagName() + "] does not exist in tag library ["+ tagLib.getClass().getName()+ "]");
    }
    if (tagLibProp instanceof Closure) {
      Closure body=new Closure(this){
        public Object doCall(){
          return call();
        }
        public Object doCall(        Object o){
          return call(new Object[]{o});
        }
        public Object doCall(        Object[] args){
          return call(args);
        }
        public Object call(        Object[] args){
          invocationCount++;
          if (args.length > 0) {
            invocationArgs.add(args[0]);
          }
 else {
            invocationArgs.add(ZERO_ARGUMENTS);
          }
          out.print("<jsp-body-gen" + invocationCount + ">");
          return null;
        }
      }
;
      Closure tag=(Closure)tagLibProp;
      if (tag.getParameterTypes().length == 1) {
        tag.call(new Object[]{attributes});
        if (body != null) {
          body.call();
        }
      }
      if (tag.getParameterTypes().length == 2) {
        tag.call(new Object[]{attributes,body});
      }
    }
 else {
      throw new GrailsTagException("Tag [" + getTagName() + "] does not exist in tag library ["+ tagLib.getClass().getName()+ "]");
    }
  }
 else {
    throw new GrailsTagException("Tag [" + getTagName() + "] does not exist. No tag library found.");
  }
  Collections.reverse(invocationArgs);
  setCurrentArgument();
  return EVAL_BODY_BUFFERED;
}
