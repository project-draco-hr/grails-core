{
  GrailsWebRequest webRequest=WebUtils.retrieveGrailsWebRequest();
  HttpServletRequest request=webRequest.getCurrentRequest();
  GroovyObject controller=webRequest.getAttributes().getController(request);
  if (grailsApplication == null) {
    grailsApplication=getApplicationContext().getBean(GrailsApplication.APPLICATION_ID,GrailsApplication.class);
  }
  GroovyPageScriptSource scriptSource=null;
  if (controller == null) {
    scriptSource=groovyPageLocator.findViewByPath(viewName);
  }
 else {
    scriptSource=groovyPageLocator.findView(controller,viewName);
  }
  if (scriptSource != null) {
    if (scriptSource instanceof GroovyPageCompiledScriptSource) {
      GroovyPageCompiledScriptSource compiled=(GroovyPageCompiledScriptSource)scriptSource;
      return createGroovyPageView(webRequest,compiled.getURI(),compiled.getCompiledClass());
    }
 else {
      return createGroovyPageView(webRequest,scriptSource.getURI());
    }
  }
  AbstractUrlBasedView view=buildView(viewName);
  view.setApplicationContext(getApplicationContext());
  view.afterPropertiesSet();
  return view;
}
