{
  Object entity=event.getObject();
  boolean newEntity=!event.getSession().contains(entity);
  if (newEntity) {
    if (beforeInsertCaller != null) {
      beforeInsertCaller.call(entity);
      if (event.getSession().contains(entity)) {
        EntityEntry entry=event.getEntry();
        if (entry != null) {
          Object[] state=entry.getLoadedState();
          synchronizePersisterState(entity,entry.getPersister(),state);
        }
      }
    }
    if (shouldTimestamp) {
      long time=System.currentTimeMillis();
      if (dateCreatedProperty != null && newEntity) {
        Object now=DefaultGroovyMethods.newInstance(dateCreatedProperty.getType(),new Object[]{time});
        dateCreatedProperty.setProperty(entity,now);
      }
      if (lastUpdatedProperty != null) {
        Object now=DefaultGroovyMethods.newInstance(lastUpdatedProperty.getType(),new Object[]{time});
        lastUpdatedProperty.setProperty(entity,now);
      }
    }
  }
}
