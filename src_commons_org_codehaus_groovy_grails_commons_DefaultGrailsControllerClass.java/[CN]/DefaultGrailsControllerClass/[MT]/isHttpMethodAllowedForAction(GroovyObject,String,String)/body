{
  boolean isAllowed=true;
  Object methodRestrictionsProperty=null;
  if (controller.getMetaClass().hasProperty(controller,ALLOWED_HTTP_METHODS_PROPERTY) != null) {
    methodRestrictionsProperty=controller.getProperty(ALLOWED_HTTP_METHODS_PROPERTY);
  }
  if (methodRestrictionsProperty instanceof Map) {
    Map map=(Map)methodRestrictionsProperty;
    if (map.containsKey(actionName)) {
      Object value=map.get(actionName);
      if (value instanceof List) {
        List listOfMethods=(List)value;
        isAllowed=listOfMethods.contains(httpMethod);
      }
 else       if (value instanceof String) {
        isAllowed=value.equals(httpMethod);
      }
    }
  }
  return isAllowed;
}
