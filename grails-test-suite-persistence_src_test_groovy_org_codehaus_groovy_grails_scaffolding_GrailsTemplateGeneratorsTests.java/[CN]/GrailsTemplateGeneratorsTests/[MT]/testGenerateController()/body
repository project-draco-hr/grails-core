{
  DefaultGrailsTemplateGenerator generator;
  GroovyClassLoader gcl=new GroovyClassLoader(Thread.currentThread().getContextClassLoader());
  generator=new DefaultGrailsTemplateGenerator();
  generator.setBasedir("../grails-resources");
  Class dc=gcl.parseClass("class Test { \n Long id;\n  Long version;  }");
  GrailsDomainClass domainClass=new DefaultGrailsDomainClass(dc);
  File generatedFile=new File("test/grails-app/controllers/TestController.groovy");
  if (generatedFile.exists()) {
    generatedFile.delete();
  }
  StringWriter sw=new StringWriter();
  generator.generateController(domainClass,sw);
  String text=sw.toString();
  Class controllerClass=gcl.parseClass(text);
  assertEquals("TestController",controllerClass.getName());
  verifyMethod(controllerClass,"create",new Class[0]);
  verifyMethod(controllerClass,"delete",new Class[]{Long.class});
  verifyMethod(controllerClass,"edit",new Class[]{Long.class});
  verifyMethod(controllerClass,"index",new Class[0]);
  verifyMethod(controllerClass,"list",new Class[]{Integer.class});
  verifyMethod(controllerClass,"save",new Class[0]);
  verifyMethod(controllerClass,"show",new Class[]{Long.class});
  verifyMethod(controllerClass,"update",new Class[]{Long.class,Long.class});
  Object propertyValue=GrailsClassUtils.getStaticPropertyValue(controllerClass,"allowedMethods");
  assertTrue("allowedMethods property was the wrong type",propertyValue instanceof Map);
  Map map=(Map)propertyValue;
  assertTrue("allowedMethods did not contain the delete action",map.containsKey("delete"));
  assertTrue("allowedMethods did not contain the save action",map.containsKey("save"));
  assertTrue("allowedMethods did not contain the update action",map.containsKey("update"));
  assertEquals("allowedMethods had incorrect value for delete action","POST",map.get("delete"));
  assertEquals("allowedMethods had incorrect value for save action","POST",map.get("save"));
  assertEquals("allowedMethods had incorrect value for update action","POST",map.get("update"));
}
