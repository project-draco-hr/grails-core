{
  if (StringUtils.isBlank(name))   return null;
  if (cacheEnabled) {
    DecoratorCacheValue cacheValue=decoratorCache.get(name);
    if (cacheValue != null && (!gspReloadEnabled || !cacheValue.isExpired())) {
      return cacheValue.getDecorator();
    }
  }
  String decoratorName=name;
  if (!name.matches("(.+)(\\.)(\\w{2}|\\w{3})")) {
    name+=DEFAULT_VIEW_TYPE;
  }
  String decoratorPage=DEFAULT_DECORATOR_PATH + '/' + name;
  ResourceLoader resourceLoader=establishResourceLoader();
  Resource res=resourceLoader.getResource(decoratorPage);
  Decorator d=null;
  if (!res.exists()) {
    String pathToView=lookupPathToControllerView(request,name);
    res=pathToView != null ? resourceLoader.getResource(pathToView) : null;
    if (res != null && res.exists()) {
      decoratorPage=pathToView;
      d=createDecorator(decoratorName,decoratorPage);
    }
 else {
      String pluginViewLocation=searchPluginViews(name,resourceLoader);
      if (pluginViewLocation == null) {
        pluginViewLocation=searchPluginViewsInBinaryPlugins(name);
      }
      if (pluginViewLocation != null) {
        decoratorPage=pluginViewLocation;
        d=createDecorator(decoratorName,decoratorPage);
      }
    }
  }
 else {
    d=createDecorator(decoratorName,decoratorPage);
  }
  if (cacheEnabled) {
    decoratorCache.put(name,new DecoratorCacheValue(d));
  }
  return d;
}
