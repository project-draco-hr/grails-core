{
  if (hasContentType)   return;
  String contentType;
  @SuppressWarnings("hiding") MimeUtility mimeUtility=lookupMimeUtility(webRequest);
  if (mimeUtility != null) {
    MimeType mimeType=mimeUtility.getMimeTypeForExtension(FilenameUtils.getExtension(fileName));
    if (mimeType != null) {
      contentType=mimeType.getName();
      Object encodingObj=argMap.get(ARGUMENT_ENCODING);
      String encoding=encodingObj != null ? encodingObj.toString() : DEFAULT_ENCODING;
      setContentType(response,contentType,encoding);
    }
 else {
      throw new ControllerExecutionException("Content type could not be determined for file: " + fileName);
    }
  }
}
