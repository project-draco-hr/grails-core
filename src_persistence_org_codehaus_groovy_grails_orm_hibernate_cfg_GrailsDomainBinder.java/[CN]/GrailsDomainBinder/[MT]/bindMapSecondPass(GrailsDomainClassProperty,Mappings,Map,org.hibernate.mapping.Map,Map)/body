{
  bindCollectionSecondPass(property,mappings,persistentClasses,map,inheritedMetas);
  String columnName=namingStrategy.propertyToColumnName(property.getName());
  SimpleValue value=new SimpleValue(map.getCollectionTable());
  bindSimpleValue(STRING_TYPE,value,true,columnName + UNDERSCORE + IndexedCollection.DEFAULT_INDEX_COLUMN_NAME,mappings);
  if (!value.isTypeSpecified()) {
    throw new MappingException("map index element must specify a type: " + map.getRole());
  }
  map.setIndex(value);
  if (!property.isOneToMany()) {
    SimpleValue elt=new SimpleValue(map.getCollectionTable());
    map.setElement(elt);
    map.setInverse(false);
    bindSimpleValue(STRING_TYPE,elt,false,columnName + UNDERSCORE + IndexedCollection.DEFAULT_ELEMENT_COLUMN_NAME,mappings);
    elt.setTypeName(STRING_TYPE);
  }
 else {
    Value element=map.getElement();
    String entityName=((OneToMany)element).getReferencedEntityName();
    PersistentClass referenced=mappings.getClass(entityName);
    IndexBackref ib=new IndexBackref();
    ib.setName(UNDERSCORE + property.getName() + "IndexBackref");
    ib.setUpdateable(false);
    ib.setSelectable(false);
    ib.setCollectionRole(map.getRole());
    ib.setEntityName(map.getOwner().getEntityName());
    ib.setValue(map.getIndex());
    referenced.addProperty(ib);
  }
}
