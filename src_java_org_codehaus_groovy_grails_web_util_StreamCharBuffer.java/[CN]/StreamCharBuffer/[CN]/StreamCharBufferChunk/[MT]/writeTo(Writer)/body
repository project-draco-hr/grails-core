{
  int writtenCount=0;
  while (charsUnread() > 0) {
    if (prepareChildArrayChunkReading()) {
      writtenCount+=readingSubChunkGroup.writeTo(target);
      if (readingSubChunkGroup.getUnreadChars() == 0) {
        readingSubChunkGroup=null;
      }
    }
    int nextCharArrPointerPos=-1;
    if (subChunkGroups != null && !subChunkGroups.isEmpty()) {
      nextCharArrPointerPos=subChunkGroups.peek().getOwnerIndex();
    }
    if (pointer < used) {
      int limit=(nextCharArrPointerPos != -1) ? nextCharArrPointerPos : used;
      int len=limit - pointer;
      target.write(buffer,pointer,len);
      writtenCount+=len;
      pointer=limit;
    }
  }
  return writtenCount;
}
